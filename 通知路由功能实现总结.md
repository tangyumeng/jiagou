# é€šçŸ¥è·¯ç”±åŠŸèƒ½å®ç°æ€»ç»“

## ğŸ“Œ é—®é¢˜èƒŒæ™¯

**ç”¨æˆ·é—®é¢˜ï¼š** "è·¯ç”±å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œappæœªå¯åŠ¨æ—¶ï¼Œæ€æ ·ä»é€šçŸ¥é‡Œé¢ä½¿ç”¨è·¯ç”±è°ƒèµ·app"

è¿™æ˜¯ä¸€ä¸ªéå¸¸å®é™…çš„ä¸šåŠ¡åœºæ™¯ï¼š
- ç”¨æˆ·æ”¶åˆ°æ¨é€é€šçŸ¥
- ç”¨æˆ·ç‚¹å‡»é€šçŸ¥
- App ä»**å®Œå…¨æœªå¯åŠ¨**çŠ¶æ€å¯åŠ¨
- è‡ªåŠ¨è·³è½¬åˆ°é€šçŸ¥æŒ‡å®šçš„é¡µé¢

### æ ¸å¿ƒæŒ‘æˆ˜

```
âŒ é—®é¢˜ï¼š
å½“ App å®Œå…¨æœªå¯åŠ¨æ—¶ï¼Œç‚¹å‡»é€šçŸ¥åï¼š
1. Window å’Œ RootViewController è¿˜æœªåˆ›å»º
2. Router.open() éœ€è¦ currentViewControllerï¼Œä½†æ­¤æ—¶ä¸º nil
3. è·¯ç”±è°ƒç”¨æ—¶æœºè¿‡æ—©ï¼ŒUI æœªå°±ç»ª

âœ… è§£å†³æ–¹æ¡ˆï¼š
å»¶è¿Ÿè·¯ç”±æœºåˆ¶ - å…ˆä¿å­˜è·¯ç”±ä¿¡æ¯ï¼Œç­‰ UI å°±ç»ªåå†æ‰§è¡Œ
```

---

## ğŸ¯ å®ç°æ–¹æ¡ˆ

### æ¶æ„è®¾è®¡

```
é€šçŸ¥ç‚¹å‡»
  â†“
AppDelegate æ¥æ”¶
  â†“
UI å°±ç»ªï¼Ÿ â€”â€”â†’ å¦ â†’ setPendingRoute()ï¼ˆä¿å­˜ï¼‰
  â†“ æ˜¯                     â†“
  â†“                   ç­‰å¾… UI å°±ç»ª
  â†“                        â†“
  â†“              HomeViewController.viewDidAppear
  â†“                        â†“
  â†“              executePendingRoute()
  â†“                        â†“
  â””â”€â”€â”€â†’ Router.open()ï¼ˆæ‰§è¡Œï¼‰
```

---

## ğŸ’» ä»£ç æ”¹åŠ¨è¯¦æƒ…

### 1. Router.swiftï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰

#### æ–°å¢å±æ€§

```swift
// å¾…å¤„ç†çš„è·¯ç”±ï¼ˆç”¨äº App å¯åŠ¨æ—¶ UI æœªå°±ç»ªçš„æƒ…å†µï¼‰
private var pendingURLString: String?
private var pendingParameters: [String: Any]?
```

#### æ–°å¢æ–¹æ³•

**1ï¸âƒ£ setPendingRoute() - è®¾ç½®å¾…å¤„ç†è·¯ç”±**

```swift
func setPendingRoute(_ urlString: String, parameters: [String: Any] = [:]) {
    if pendingURLString != nil {
        print("âš ï¸ è¦†ç›–ä¹‹å‰çš„å¾…å¤„ç†è·¯ç”±ï¼š\(pendingURLString!)")
    }
    print("ğŸ“Œ è®¾ç½®å¾…å¤„ç†è·¯ç”±ï¼š\(urlString)")
    pendingURLString = urlString
    pendingParameters = parameters
}
```

**ä½¿ç”¨åœºæ™¯ï¼š** App å¯åŠ¨æ—¶ï¼ŒUI è¿˜æœªå°±ç»ªï¼Œå…ˆä¿å­˜è·¯ç”±ä¿¡æ¯

---

**2ï¸âƒ£ executePendingRoute() - æ‰§è¡Œå¾…å¤„ç†è·¯ç”±**

```swift
@discardableResult
func executePendingRoute() -> Bool {
    guard let urlString = pendingURLString else {
        return false
    }
    
    print("ğŸš€ æ‰§è¡Œå¾…å¤„ç†è·¯ç”±ï¼š\(urlString)")
    
    let parameters = pendingParameters ?? [:]
    
    // æ¸…é™¤å¾…å¤„ç†çš„è·¯ç”±
    pendingURLString = nil
    pendingParameters = nil
    
    // å»¶è¿Ÿæ‰§è¡Œï¼Œç¡®ä¿ UI å®Œå…¨å°±ç»ª
    DispatchQueue.main.asyncAfter(deadline: .now() + 0.5) { [weak self] in
        self?.open(urlString, parameters: parameters)
    }
    
    return true
}
```

**ä½¿ç”¨åœºæ™¯ï¼š** UI å°±ç»ªåï¼ˆé€šå¸¸åœ¨ viewDidAppear ä¸­ï¼‰è°ƒç”¨

**ä¸ºä»€ä¹ˆå»¶è¿Ÿ 0.5 ç§’ï¼Ÿ**
- ç¡®ä¿ navigationController å®Œå…¨åˆå§‹åŒ–
- ç¡®ä¿åŠ¨ç”»è¿‡æ¸¡å®Œæˆ
- é¿å…ç•Œé¢é—ªçƒ

---

**3ï¸âƒ£ hasPendingRoute - æ£€æŸ¥æ˜¯å¦æœ‰å¾…å¤„ç†è·¯ç”±**

```swift
var hasPendingRoute: Bool {
    return pendingURLString != nil
}
```

**ä½¿ç”¨åœºæ™¯ï¼š** åœ¨ viewDidAppear ä¸­åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰§è¡Œå»¶è¿Ÿè·¯ç”±

---

**4ï¸âƒ£ clearPendingRoute() - æ¸…é™¤å¾…å¤„ç†è·¯ç”±**

```swift
func clearPendingRoute() {
    if pendingURLString != nil {
        print("ğŸ—‘ï¸ æ¸…é™¤å¾…å¤„ç†è·¯ç”±ï¼š\(pendingURLString!)")
    }
    pendingURLString = nil
    pendingParameters = nil
}
```

**ä½¿ç”¨åœºæ™¯ï¼š** å–æ¶ˆè·¯ç”±æˆ–é‡ç½®çŠ¶æ€

---

### 2. AppDelegate.swiftï¼ˆé€šçŸ¥å¤„ç†ï¼‰

#### å¯¼å…¥æ¡†æ¶

```swift
import UserNotifications
```

#### didFinishLaunching æ”¹åŠ¨

```swift
func application(...) -> Bool {
    // 1. æ³¨å†Œæ‰€æœ‰è·¯ç”±
    registerAllRoutes()
    
    // 2. è¯·æ±‚é€šçŸ¥æƒé™ï¼ˆæ–°å¢ï¼‰
    requestNotificationPermission()
    
    // 3. å¤„ç†ä»é€šçŸ¥å¯åŠ¨çš„æƒ…å†µï¼ˆæ–°å¢ï¼‰
    handleLaunchFromNotification(launchOptions: launchOptions)
    
    return true
}
```

#### æ–°å¢æ–¹æ³•

**1ï¸âƒ£ requestNotificationPermission() - è¯·æ±‚é€šçŸ¥æƒé™**

```swift
private func requestNotificationPermission() {
    UNUserNotificationCenter.current().requestAuthorization(options: [.alert, .sound, .badge]) { granted, error in
        if granted {
            print("âœ… é€šçŸ¥æƒé™å·²æˆäºˆ")
            DispatchQueue.main.async {
                UIApplication.shared.registerForRemoteNotifications()
            }
        } else if let error = error {
            print("âŒ é€šçŸ¥æƒé™è¢«æ‹’ç»ï¼š\(error.localizedDescription)")
        }
    }
    
    // è®¾ç½®é€šçŸ¥ä»£ç†
    UNUserNotificationCenter.current().delegate = self
}
```

---

**2ï¸âƒ£ handleLaunchFromNotification() - å¤„ç†ä»é€šçŸ¥å¯åŠ¨**

```swift
private func handleLaunchFromNotification(launchOptions: [UIApplication.LaunchOptionsKey: Any]?) {
    
    // åœºæ™¯ï¼šä»è¿œç¨‹æ¨é€é€šçŸ¥å¯åŠ¨
    if let remoteNotification = launchOptions?[.remoteNotification] as? [AnyHashable: Any] {
        print("ğŸ”” ä»è¿œç¨‹é€šçŸ¥å¯åŠ¨ App")
        handleNotificationPayload(remoteNotification, isLaunch: true)
    }
}
```

**å…³é”®ç‚¹ï¼š** `isLaunch: true` è¡¨ç¤º App æ­£åœ¨å¯åŠ¨ï¼ŒUI æœªå°±ç»ª

---

**3ï¸âƒ£ handleNotificationPayload() - å¤„ç†é€šçŸ¥è´Ÿè½½**

```swift
private func handleNotificationPayload(_ userInfo: [AnyHashable: Any], isLaunch: Bool) {
    print("ğŸ“¦ é€šçŸ¥å†…å®¹ï¼š\(userInfo)")
    
    // ä»é€šçŸ¥ä¸­æå–è·¯ç”±ä¿¡æ¯
    guard let routeString = userInfo["route"] as? String else {
        print("âš ï¸ é€šçŸ¥ä¸­æ²¡æœ‰è·¯ç”±ä¿¡æ¯")
        return
    }
    
    print("ğŸ”— æå–åˆ°è·¯ç”±ï¼š\(routeString)")
    
    // æå–é¢å¤–å‚æ•°
    var parameters: [String: Any] = [:]
    if let params = userInfo["parameters"] as? [String: Any] {
        parameters = params
    }
    
    if isLaunch {
        // App å¯åŠ¨åœºæ™¯ï¼šè®¾ç½®å¾…å¤„ç†è·¯ç”±
        print("ğŸ“Œ App æ­£åœ¨å¯åŠ¨ï¼Œè®¾ç½®å¾…å¤„ç†è·¯ç”±")
        Router.shared.setPendingRoute(routeString, parameters: parameters)
    } else {
        // App å·²è¿è¡Œåœºæ™¯ï¼šç›´æ¥æ‰§è¡Œè·¯ç”±
        print("ğŸš€ App å·²è¿è¡Œï¼Œç›´æ¥æ‰§è¡Œè·¯ç”±")
        Router.shared.open(routeString, parameters: parameters)
    }
}
```

**æ ¸å¿ƒé€»è¾‘ï¼š**
- å¯åŠ¨åœºæ™¯ â†’ `setPendingRoute()` å»¶è¿Ÿæ‰§è¡Œ
- å·²è¿è¡Œåœºæ™¯ â†’ `open()` ç›´æ¥æ‰§è¡Œ

---

**4ï¸âƒ£ application(_:open:options:) - URL Scheme å¤„ç†**

```swift
func application(_ app: UIApplication, open url: URL, options: [UIApplication.OpenURLOptionsKey: Any] = [:]) -> Bool {
    print("ğŸ”— é€šè¿‡ URL Scheme æ‰“å¼€ï¼š\(url)")
    
    // æ£€æŸ¥ UI æ˜¯å¦å°±ç»ª
    if Router.shared.currentViewController() != nil {
        // UI å·²å°±ç»ªï¼Œç›´æ¥æ‰§è¡Œ
        return Router.shared.open(url)
    } else {
        // UI æœªå°±ç»ªï¼Œè®¾ç½®å¾…å¤„ç†è·¯ç”±
        Router.shared.setPendingRoute(url.absoluteString)
        return true
    }
}
```

**ä½¿ç”¨åœºæ™¯ï¼š** ä»å…¶ä»– App é€šè¿‡ URL Scheme å”¤èµ·

---

#### UNUserNotificationCenterDelegate å®ç°

```swift
extension AppDelegate: UNUserNotificationCenterDelegate {
    
    /// å‰å°æ”¶åˆ°é€šçŸ¥
    func userNotificationCenter(_ center: UNUserNotificationCenter, 
                               willPresent notification: UNNotification, 
                               withCompletionHandler completionHandler: @escaping (UNNotificationPresentationOptions) -> Void) {
        print("ğŸ”” å‰å°æ”¶åˆ°é€šçŸ¥ï¼š\(notification.request.content.userInfo)")
        
        // iOS 14+ æ˜¾ç¤º banner
        if #available(iOS 14.0, *) {
            completionHandler([.banner, .sound, .badge])
        } else {
            completionHandler([.alert, .sound, .badge])
        }
    }
    
    /// ç”¨æˆ·ç‚¹å‡»é€šçŸ¥
    func userNotificationCenter(_ center: UNUserNotificationCenter, 
                               didReceive response: UNNotificationResponse, 
                               withCompletionHandler completionHandler: @escaping () -> Void) {
        print("ğŸ”” ç”¨æˆ·ç‚¹å‡»äº†é€šçŸ¥")
        
        let userInfo = response.notification.request.content.userInfo
        
        // æ£€æŸ¥ App æ˜¯å¦åˆšå¯åŠ¨ï¼ˆUI æœªå°±ç»ªï¼‰
        let isLaunch = Router.shared.currentViewController() == nil
        
        handleNotificationPayload(userInfo, isLaunch: isLaunch)
        
        completionHandler()
    }
}
```

**å…³é”®åˆ¤æ–­ï¼š**
```swift
let isLaunch = Router.shared.currentViewController() == nil
```
- `nil` = UI æœªå°±ç»ª â†’ å»¶è¿Ÿè·¯ç”±
- `énil` = UI å·²å°±ç»ª â†’ ç›´æ¥æ‰§è¡Œ

---

### 3. HomeViewController.swiftï¼ˆæ‰§è¡Œå»¶è¿Ÿè·¯ç”±ï¼‰

#### viewDidAppear æ”¹åŠ¨

```swift
override func viewDidAppear(_ animated: Bool) {
    super.viewDidAppear(animated)
    
    // æ‰§è¡Œå¾…å¤„ç†çš„è·¯ç”±ï¼ˆå¦‚æœæœ‰ï¼‰
    // ä½¿ç”¨åœºæ™¯ï¼šApp ä»é€šçŸ¥æˆ– URL Scheme å¯åŠ¨æ—¶ï¼ŒUI æœªå°±ç»ªï¼Œè·¯ç”±è¢«å»¶è¿Ÿ
    if Router.shared.hasPendingRoute {
        print("ğŸš€ HomeViewController å·²å°±ç»ªï¼Œæ‰§è¡Œå¾…å¤„ç†è·¯ç”±")
        Router.shared.executePendingRoute()
    }
}
```

**ä¸ºä»€ä¹ˆåœ¨ HomeViewControllerï¼Ÿ**
- HomeViewController æ˜¯ RootViewController
- ç¬¬ä¸€ä¸ª viewDidAppear æ—¶ï¼ŒUI å·²å®Œå…¨å°±ç»ª
- navigationController å·²åˆå§‹åŒ–

---

### 4. RouterDemoViewController.swiftï¼ˆæµ‹è¯•åŠŸèƒ½ï¼‰

#### å¯¼å…¥æ¡†æ¶

```swift
import UserNotifications
```

#### æ–°å¢ UI ç»„ä»¶

```swift
private let section4Label = UILabel()
private let button7 = UIButton(type: .system)
```

#### æ–°å¢æµ‹è¯•æ–¹æ³•

```swift
@objc private func testNotification() {
    log("ğŸ“¤ å‡†å¤‡å‘é€æœ¬åœ°é€šçŸ¥...")
    
    // åˆ›å»ºé€šçŸ¥å†…å®¹
    let content = UNMutableNotificationContent()
    content.title = "è·¯ç”±æµ‹è¯•é€šçŸ¥"
    content.body = "ç‚¹å‡»æ­¤é€šçŸ¥å°†è·³è½¬åˆ° VIP é¡µé¢"
    content.sound = .default
    content.badge = 1
    
    // æ·»åŠ è·¯ç”±ä¿¡æ¯åˆ°é€šçŸ¥è´Ÿè½½
    content.userInfo = [
        "route": "app://vip/999",
        "parameters": [
            "from": "notification",
            "message": "é€šçŸ¥è·¯ç”±æµ‹è¯•æˆåŠŸï¼"
        ]
    ]
    
    // 5ç§’åè§¦å‘
    let trigger = UNTimeIntervalNotificationTrigger(timeInterval: 5, repeats: false)
    
    let request = UNNotificationRequest(
        identifier: UUID().uuidString,
        content: content,
        trigger: trigger
    )
    
    // æ·»åŠ é€šçŸ¥è¯·æ±‚
    UNUserNotificationCenter.current().add(request) { [weak self] error in
        DispatchQueue.main.async {
            if let error = error {
                self?.log("âŒ é€šçŸ¥å‘é€å¤±è´¥ï¼š\(error.localizedDescription)")
            } else {
                self?.log("âœ… é€šçŸ¥å·²è°ƒåº¦ï¼ˆ5ç§’åè§¦å‘ï¼‰")
                self?.log("ğŸ’¡ æç¤ºï¼š")
                self?.log("  1. å‰å°ï¼šç­‰å¾…é€šçŸ¥ banner å¹¶ç‚¹å‡»")
                self?.log("  2. åå°ï¼šæŒ‰ Home é”®ï¼Œç­‰å¾…å¹¶ç‚¹å‡»é€šçŸ¥")
                self?.log("  3. æ€æ­» Appï¼šä»å¤šä»»åŠ¡ç®¡ç†å™¨æ€æ­» Appï¼Œç­‰å¾…å¹¶ç‚¹å‡»é€šçŸ¥")
            }
        }
    }
}
```

---

## ğŸ“Š å®Œæ•´ç”Ÿå‘½å‘¨æœŸæµç¨‹

### åœºæ™¯ 1ï¼šApp å®Œå…¨æœªå¯åŠ¨ + ç‚¹å‡»é€šçŸ¥

```
ç”¨æˆ·ç‚¹å‡»é€šçŸ¥
  â†“
ç³»ç»Ÿå¯åŠ¨ App
  â†“
1. AppDelegate.didFinishLaunching
   - registerAllRoutes()
   - requestNotificationPermission()
   - handleLaunchFromNotification(launchOptions)
     â†’ æ£€æµ‹åˆ°é€šçŸ¥å¯åŠ¨
     â†’ handleNotificationPayload(userInfo, isLaunch: true)
       â†’ Router.setPendingRoute("app://vip/999") âœ…
  â†“
2. SceneDelegate.willConnectTo
   - åˆ›å»º Window
   - åˆ›å»º RootViewController (HomeViewController)
   - window.makeKeyAndVisible()
  â†“
3. HomeViewController.viewDidLoad
  â†“
4. HomeViewController.viewWillAppear
  â†“
5. HomeViewController.viewDidAppear âœ…
   - Router.hasPendingRoute â†’ true
   - Router.executePendingRoute()
     â†’ å»¶è¿Ÿ 0.5 ç§’
     â†’ Router.open("app://vip/999")
       â†’ åŒ¹é…è·¯ç”± app://vip/:vipId
       â†’ åˆ›å»º RouteVIPViewController
       â†’ navigationController.push
  â†“
âœ… è·³è½¬åˆ° VIP é¡µé¢
```

### åœºæ™¯ 2ï¼šApp åœ¨åå° + ç‚¹å‡»é€šçŸ¥

```
ç”¨æˆ·ç‚¹å‡»é€šçŸ¥
  â†“
App å›åˆ°å‰å°
  â†“
UNUserNotificationCenterDelegate.didReceive
  - currentViewController != nilï¼ˆUI å·²å°±ç»ªï¼‰
  - handleNotificationPayload(userInfo, isLaunch: false)
    â†’ Router.open("app://vip/999") ç›´æ¥æ‰§è¡Œ âœ…
  â†“
âœ… è·³è½¬åˆ° VIP é¡µé¢
```

### åœºæ™¯ 3ï¼šApp åœ¨å‰å° + æ”¶åˆ°é€šçŸ¥

```
æ”¶åˆ°é€šçŸ¥
  â†“
UNUserNotificationCenterDelegate.willPresent
  - æ˜¾ç¤º banner
  â†“
ç”¨æˆ·ç‚¹å‡» banner
  â†“
UNUserNotificationCenterDelegate.didReceive
  - currentViewController != nilï¼ˆUI å·²å°±ç»ªï¼‰
  - Router.open("app://vip/999") ç›´æ¥æ‰§è¡Œ âœ…
  â†“
âœ… è·³è½¬åˆ° VIP é¡µé¢
```

---

## ğŸ¯ é€šçŸ¥è´Ÿè½½æ ¼å¼

### æ ‡å‡†æ ¼å¼

```json
{
  "aps": {
    "alert": {
      "title": "é€šçŸ¥æ ‡é¢˜",
      "body": "é€šçŸ¥å†…å®¹"
    },
    "sound": "default",
    "badge": 1
  },
  "route": "app://vip/999",
  "parameters": {
    "from": "notification",
    "message": "è‡ªå®šä¹‰æ¶ˆæ¯"
  }
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ | å¿…éœ€ | è¯´æ˜ |
|------|------|------|
| `aps` | âœ… | ç³»ç»Ÿé€šçŸ¥é…ç½® |
| `route` | âœ… | è·¯ç”± URL |
| `parameters` | âŒ | é¢å¤–å‚æ•°ï¼ˆä¼šåˆå¹¶åˆ°è·¯ç”±å‚æ•°ï¼‰ |

### å®é™…æ¡ˆä¾‹

**1. è®¢å•é€šçŸ¥**
```json
{
  "aps": {"alert": "æ‚¨æœ‰æ–°è®¢å•"},
  "route": "app://order/12345"
}
```

**2. å•†å“æ¨è**
```json
{
  "aps": {"alert": "é™æ—¶ä¼˜æƒ "},
  "route": "app://product/8888",
  "parameters": {
    "name": "iPhone",
    "discount": "0.8"
  }
}
```

**3. æ´»åŠ¨æ¨å¹¿**
```json
{
  "aps": {"alert": "ç­¾åˆ°é¢†çº¢åŒ…"},
  "route": "app://activity/signin"
}
```

---

## âœ… æ–‡ä»¶æ¸…å•

ä¿®æ”¹çš„æ–‡ä»¶ï¼š

1. âœ… `jiagou/Router.swift` - æ·»åŠ å»¶è¿Ÿè·¯ç”±åŠŸèƒ½
2. âœ… `jiagou/AppDelegate.swift` - å¤„ç†é€šçŸ¥å’Œæƒé™
3. âœ… `jiagou/HomeViewController.swift` - æ‰§è¡Œå»¶è¿Ÿè·¯ç”±
4. âœ… `jiagou/RouterDemoViewController.swift` - æ·»åŠ æµ‹è¯•åŠŸèƒ½

æ–°å¢çš„æ–‡æ¡£ï¼š

1. âœ… `é€šçŸ¥è·¯ç”±å¯åŠ¨æ–¹æ¡ˆ.md` - è¯¦ç»†è®¾è®¡æ–‡æ¡£
2. âœ… `é€šçŸ¥è·¯ç”±å¿«é€Ÿæµ‹è¯•æŒ‡å—.md` - æµ‹è¯•æŒ‡å—
3. âœ… `é€šçŸ¥è·¯ç”±åŠŸèƒ½å®ç°æ€»ç»“.md` - æœ¬æ–‡æ¡£

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### å¿«é€Ÿæµ‹è¯•

```
1. è¿è¡Œ App
2. ä¸»é¡µ â†’ è·¯ç”±æ¡†æ¶
3. ç‚¹å‡» [å‘é€æµ‹è¯•é€šçŸ¥ï¼ˆ5ç§’åï¼‰]
4. ä»å¤šä»»åŠ¡ç®¡ç†å™¨æ€æ­» App
5. ç­‰å¾…é€šçŸ¥å‡ºç°
6. ç‚¹å‡»é€šçŸ¥
7. âœ… App å¯åŠ¨å¹¶è·³è½¬åˆ° VIP é¡µé¢
```

### éªŒè¯æ¸…å•

- [ ] å‰å°é€šçŸ¥èƒ½æ­£å¸¸è·³è½¬
- [ ] åå°é€šçŸ¥èƒ½æ­£å¸¸è·³è½¬
- [ ] å®Œå…¨å¯åŠ¨èƒ½æ­£å¸¸è·³è½¬
- [ ] æ§åˆ¶å°æ—¥å¿—æ­£ç¡®
- [ ] å‚æ•°æ­£ç¡®ä¼ é€’

---

## ğŸ’¡ æŠ€æœ¯äº®ç‚¹

### 1. å»¶è¿Ÿè·¯ç”±æœºåˆ¶

```swift
âœ… ä¼˜ç‚¹ï¼š
- è§£å†³ UI æœªå°±ç»ªé—®é¢˜
- ç»Ÿä¸€å¤„ç†å¯åŠ¨å’Œè¿è¡Œåœºæ™¯
- ç”¨æˆ·ä½“éªŒæµç•…

âŒ å¦‚æœæ²¡æœ‰å»¶è¿Ÿè·¯ç”±ï¼š
- currentViewController() è¿”å› nil
- è·¯ç”±æ‰§è¡Œå¤±è´¥
- ç”¨æˆ·çœ‹åˆ°é¦–é¡µï¼Œéœ€è¦æ‰‹åŠ¨å¯¼èˆª
```

### 2. æ™ºèƒ½åˆ¤æ–­

```swift
let isLaunch = Router.shared.currentViewController() == nil
```

é€šè¿‡æ£€æŸ¥ currentViewController åˆ¤æ–­ UI æ˜¯å¦å°±ç»ªï¼Œè‡ªåŠ¨é€‰æ‹©æ‰§è¡Œç­–ç•¥ã€‚

### 3. å‚æ•°åˆå¹¶

```swift
è·¯å¾„å‚æ•° + Queryå‚æ•° + é€šçŸ¥å‚æ•° â†’ è‡ªåŠ¨åˆå¹¶
```

### 4. å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸå¤„ç†

- âœ… didFinishLaunching - å¯åŠ¨æ—¶å¤„ç†
- âœ… didReceive - å‰å°/åå°å¤„ç†
- âœ… viewDidAppear - æ‰§è¡Œå»¶è¿Ÿè·¯ç”±

---

## ğŸ‰ æ€»ç»“

### å®ç°çš„åŠŸèƒ½

âœ… **å»¶è¿Ÿè·¯ç”±æœºåˆ¶** - è§£å†³ UI æœªå°±ç»ªé—®é¢˜  
âœ… **é€šçŸ¥æƒé™ç®¡ç†** - è‡ªåŠ¨è¯·æ±‚å’Œå¤„ç†  
âœ… **å®Œæ•´ç”Ÿå‘½å‘¨æœŸ** - æ”¯æŒæ‰€æœ‰å¯åŠ¨åœºæ™¯  
âœ… **URL Scheme** - å¤–éƒ¨å”¤èµ·æ”¯æŒ  
âœ… **æµ‹è¯•å·¥å…·** - å†…ç½®æµ‹è¯•æŒ‰é’®  
âœ… **è¯¦ç»†æ—¥å¿—** - æ–¹ä¾¿è°ƒè¯•  

### æŠ€æœ¯ä»·å€¼

ğŸ¯ **å®é™…ä¸šåŠ¡åœºæ™¯** - è§£å†³çœŸå®é—®é¢˜  
ğŸ¯ **æ¶æ„è®¾è®¡** - å»¶è¿Ÿæ‰§è¡Œæ¨¡å¼  
ğŸ¯ **ç”Ÿå‘½å‘¨æœŸç®¡ç†** - å®Œæ•´ç†è§£  
ğŸ¯ **é¢è¯•ä»·å€¼** - é«˜é¢‘è€ƒç‚¹  

### é€‚ç”¨åœºæ™¯

ğŸ“± æ¨é€é€šçŸ¥è·³è½¬  
ğŸ“± æ·±åº¦é“¾æ¥ï¼ˆDeep Linkingï¼‰  
ğŸ“± Universal Links  
ğŸ“± URL Scheme å”¤èµ·  
ğŸ“± Widget ç‚¹å‡»è·³è½¬  
ğŸ“± 3D Touch å¿«æ·æ“ä½œ  

---

**å®ç°å®Œæˆï¼ç«‹å³è¿è¡Œé¡¹ç›®æµ‹è¯•é€šçŸ¥è·¯ç”±åŠŸèƒ½ï¼ğŸš€**

