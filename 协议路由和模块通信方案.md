# åè®®è·¯ç”±å’Œæ¨¡å—é€šä¿¡æ–¹æ¡ˆ

## ğŸ“Œ æ–¹æ¡ˆå¯¹æ¯”

### ç°æœ‰æ–¹æ¡ˆï¼šURL-Based Router

```swift
// ä¼˜ç‚¹ï¼š
âœ… æ”¯æŒå¤–éƒ¨å”¤èµ·ï¼ˆURL Schemeã€Universal Linksï¼‰
âœ… çµæ´»ï¼ˆé€šè¿‡ URL å­—ç¬¦ä¸²ï¼‰
âœ… æ”¯æŒè¿œç¨‹é…ç½®
âœ… é€‚åˆ H5 äº¤äº’

// ç¼ºç‚¹ï¼š
âŒ æ— ç±»å‹å®‰å…¨ï¼ˆå­—ç¬¦ä¸² URLï¼‰
âŒ æ— ç¼–è¯‘æ£€æŸ¥ï¼ˆè¿è¡Œæ—¶æ‰çŸ¥é“é”™è¯¯ï¼‰
âŒ åªèƒ½é¡µé¢è·³è½¬ï¼ˆä¸æ”¯æŒæœåŠ¡è°ƒç”¨ï¼‰
âŒ å‚æ•°ä¼ é€’éº»çƒ¦ï¼ˆéœ€è¦åºåˆ—åŒ–ï¼‰
```

### æ–°æ–¹æ¡ˆï¼šProtocol-Based + Mediator

```swift
// ä¼˜ç‚¹ï¼š
âœ… ç±»å‹å®‰å…¨ï¼ˆåè®®å®šä¹‰æ¥å£ï¼‰
âœ… ç¼–è¯‘æ—¶æ£€æŸ¥ï¼ˆå‚æ•°ç±»å‹é”™è¯¯ç«‹å³å‘ç°ï¼‰
âœ… æ”¯æŒé¡µé¢è·³è½¬
âœ… æ”¯æŒæœåŠ¡è°ƒç”¨ï¼ˆæ¨¡å—é—´é€šä¿¡ï¼‰
âœ… æ”¯æŒä¾èµ–æ³¨å…¥
âœ… é€‚åˆç»„ä»¶åŒ–æ¶æ„

// ç¼ºç‚¹ï¼š
âŒ ä¸æ”¯æŒå¤–éƒ¨å”¤èµ·
âŒ éœ€è¦å®šä¹‰åè®®ï¼ˆä»£ç é‡ç¨å¤šï¼‰
âŒ æ— æ³•è¿œç¨‹é…ç½®
```

---

## ğŸ¯ è®¾è®¡æ€è·¯

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          App ä¸»å·¥ç¨‹                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚    â”‚   ModuleManager         â”‚         â”‚
â”‚    â”‚   (ä¸­ä»‹è€…/æœåŠ¡æ€»çº¿)      â”‚         â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚              â†•                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚    â”‚   Protocol Layer        â”‚         â”‚
â”‚    â”‚   (åè®®å±‚)               â”‚         â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚              â†•                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ ç”¨æˆ·  â”‚  â”‚ å•†å“  â”‚  â”‚ è®¢å•  â”‚  ...    â”‚
â”‚  â”‚ æ¨¡å—  â”‚  â”‚ æ¨¡å—  â”‚  â”‚ æ¨¡å—  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ¯ä¸ªæ¨¡å—ï¼š
- å®šä¹‰åè®®ï¼ˆProtocolï¼‰
- å®ç°åè®®ï¼ˆImplementationï¼‰
- æ³¨å†Œåˆ° ModuleManager
```

---

## ğŸ’» æ ¸å¿ƒå®ç°

### 1. æ¨¡å—åè®®å®šä¹‰

```swift
/// æ¨¡å—åè®®åŸºç±»
protocol ModuleProtocol {
    /// æ¨¡å—åç§°
    static var moduleName: String { get }
    
    /// æ¨¡å—åˆå§‹åŒ–
    init()
}

/// é¡µé¢æ¨¡å—åè®®ï¼ˆå¯ä»¥åˆ›å»º ViewControllerï¼‰
protocol PageModuleProtocol: ModuleProtocol {
    /// åˆ›å»ºé¡µé¢
    func createViewController(with parameters: [String: Any]) -> UIViewController?
}

/// æœåŠ¡æ¨¡å—åè®®ï¼ˆæä¾›æœåŠ¡ï¼Œä¸åˆ›å»ºé¡µé¢ï¼‰
protocol ServiceModuleProtocol: ModuleProtocol {
    /// æœåŠ¡æ–¹æ³•ï¼ˆå­ç±»è‡ªå®šä¹‰ï¼‰
}
```

---

### 2. æ¨¡å—ç®¡ç†å™¨ï¼ˆMediator ä¸­ä»‹è€…ï¼‰

```swift
/// æ¨¡å—ç®¡ç†å™¨ï¼ˆå•ä¾‹ï¼‰
class ModuleManager {
    static let shared = ModuleManager()
    
    // æ³¨å†Œçš„æ¨¡å—
    private var modules: [String: ModuleProtocol.Type] = [:]
    
    // æ¨¡å—å®ä¾‹ç¼“å­˜ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰
    private var instances: [String: ModuleProtocol] = [:]
    
    private init() {}
    
    // MARK: - æ³¨å†Œæ¨¡å—
    
    /// æ³¨å†Œæ¨¡å—
    func register<T: ModuleProtocol>(_ moduleType: T.Type) {
        let moduleName = moduleType.moduleName
        modules[moduleName] = moduleType
        print("âœ… æ³¨å†Œæ¨¡å—ï¼š\(moduleName)")
    }
    
    // MARK: - è·å–æ¨¡å—
    
    /// è·å–æ¨¡å—å®ä¾‹ï¼ˆå•ä¾‹ï¼‰
    func module<T: ModuleProtocol>(_ type: T.Type) -> T? {
        let moduleName = type.moduleName
        
        // ä»ç¼“å­˜è·å–
        if let instance = instances[moduleName] as? T {
            return instance
        }
        
        // åˆ›å»ºæ–°å®ä¾‹
        guard let moduleType = modules[moduleName] as? T.Type else {
            print("âŒ æ¨¡å—æœªæ³¨å†Œï¼š\(moduleName)")
            return nil
        }
        
        let instance = moduleType.init()
        instances[moduleName] = instance
        return instance
    }
    
    // MARK: - é¡µé¢è·³è½¬
    
    /// æ‰“å¼€é¡µé¢
    @discardableResult
    func openPage<T: PageModuleProtocol>(
        _ moduleType: T.Type,
        parameters: [String: Any] = [:],
        from source: UIViewController?,
        animated: Bool = true
    ) -> Bool {
        guard let module = self.module(moduleType) else {
            return false
        }
        
        guard let destination = module.createViewController(with: parameters) else {
            print("âŒ åˆ›å»ºé¡µé¢å¤±è´¥")
            return false
        }
        
        // æ‰§è¡Œè·³è½¬
        guard let source = source ?? Router.shared.currentViewController() else {
            print("âŒ æ²¡æœ‰æº ViewController")
            return false
        }
        
        source.navigationController?.pushViewController(destination, animated: animated)
        return true
    }
}
```

---

### 3. å…·ä½“æ¨¡å—ç¤ºä¾‹

#### ç”¨æˆ·æ¨¡å—åè®®

```swift
/// ç”¨æˆ·æ¨¡å—åè®®
protocol UserModuleProtocol: PageModuleProtocol, ServiceModuleProtocol {
    /// åˆ›å»ºç”¨æˆ·è¯¦æƒ…é¡µ
    func createUserDetailPage(userId: String) -> UIViewController?
    
    /// åˆ›å»ºç”¨æˆ·åˆ—è¡¨é¡µ
    func createUserListPage() -> UIViewController?
    
    /// è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ï¼ˆæœåŠ¡ï¼‰
    func getCurrentUser() -> User?
    
    /// ç™»å½•ï¼ˆæœåŠ¡ï¼‰
    func login(username: String, password: String, completion: @escaping (Bool) -> Void)
    
    /// ç™»å‡ºï¼ˆæœåŠ¡ï¼‰
    func logout()
}

/// ç”¨æˆ·æ¨¡å—å®ç°
class UserModule: UserModuleProtocol {
    static let moduleName = "UserModule"
    
    required init() {}
    
    // MARK: - PageModuleProtocol
    
    func createViewController(with parameters: [String : Any]) -> UIViewController? {
        // æ ¹æ®å‚æ•°å†³å®šåˆ›å»ºå“ªä¸ªé¡µé¢
        if let userId = parameters["userId"] as? String {
            return createUserDetailPage(userId: userId)
        } else {
            return createUserListPage()
        }
    }
    
    // MARK: - é¡µé¢åˆ›å»º
    
    func createUserDetailPage(userId: String) -> UIViewController? {
        let vc = UserDetailViewController()
        vc.userId = userId
        return vc
    }
    
    func createUserListPage() -> UIViewController? {
        return UserListViewController()
    }
    
    // MARK: - æœåŠ¡æ–¹æ³•
    
    func getCurrentUser() -> User? {
        // ä»æœ¬åœ°æˆ–ç½‘ç»œè·å–ç”¨æˆ·ä¿¡æ¯
        return User(id: "123", name: "å¼ ä¸‰", avatar: "avatar.jpg")
    }
    
    func login(username: String, password: String, completion: @escaping (Bool) -> Void) {
        // æ‰§è¡Œç™»å½•é€»è¾‘
        print("ğŸ” ç™»å½•ï¼š\(username)")
        DispatchQueue.main.asyncAfter(deadline: .now() + 1) {
            completion(true)
        }
    }
    
    func logout() {
        print("ğŸ”“ ç™»å‡º")
        // æ¸…é™¤ç”¨æˆ·ä¿¡æ¯
    }
}
```

#### å•†å“æ¨¡å—åè®®

```swift
/// å•†å“æ¨¡å—åè®®
protocol ProductModuleProtocol: PageModuleProtocol, ServiceModuleProtocol {
    /// åˆ›å»ºå•†å“è¯¦æƒ…é¡µ
    func createProductDetailPage(productId: String) -> UIViewController?
    
    /// åˆ›å»ºå•†å“åˆ—è¡¨é¡µ
    func createProductListPage(category: String?) -> UIViewController?
    
    /// è·å–å•†å“ä¿¡æ¯ï¼ˆæœåŠ¡ï¼‰
    func getProduct(productId: String, completion: @escaping (Product?) -> Void)
    
    /// æ·»åŠ åˆ°è´­ç‰©è½¦ï¼ˆæœåŠ¡ï¼‰
    func addToCart(productId: String, quantity: Int) -> Bool
}

/// å•†å“æ¨¡å—å®ç°
class ProductModule: ProductModuleProtocol {
    static let moduleName = "ProductModule"
    
    required init() {}
    
    // MARK: - PageModuleProtocol
    
    func createViewController(with parameters: [String : Any]) -> UIViewController? {
        if let productId = parameters["productId"] as? String {
            return createProductDetailPage(productId: productId)
        } else {
            let category = parameters["category"] as? String
            return createProductListPage(category: category)
        }
    }
    
    // MARK: - é¡µé¢åˆ›å»º
    
    func createProductDetailPage(productId: String) -> UIViewController? {
        let vc = ProductDetailViewController()
        vc.productId = productId
        return vc
    }
    
    func createProductListPage(category: String?) -> UIViewController? {
        let vc = ProductListViewController()
        vc.category = category
        return vc
    }
    
    // MARK: - æœåŠ¡æ–¹æ³•
    
    func getProduct(productId: String, completion: @escaping (Product?) -> Void) {
        // ä»ç½‘ç»œè·å–å•†å“ä¿¡æ¯
        print("ğŸ“¦ è·å–å•†å“ï¼š\(productId)")
        DispatchQueue.main.asyncAfter(deadline: .now() + 0.5) {
            let product = Product(id: productId, name: "iPhone 15", price: 5999)
            completion(product)
        }
    }
    
    func addToCart(productId: String, quantity: Int) -> Bool {
        print("ğŸ›’ æ·»åŠ åˆ°è´­ç‰©è½¦ï¼š\(productId) x\(quantity)")
        return true
    }
}
```

---

## ğŸ“± ä½¿ç”¨æ–¹å¼

### 1. æ³¨å†Œæ¨¡å—ï¼ˆAppDelegateï¼‰

```swift
func application(...) -> Bool {
    // æ³¨å†Œæ‰€æœ‰æ¨¡å—
    registerModules()
    return true
}

func registerModules() {
    let manager = ModuleManager.shared
    
    // æ³¨å†Œç”¨æˆ·æ¨¡å—
    manager.register(UserModule.self)
    
    // æ³¨å†Œå•†å“æ¨¡å—
    manager.register(ProductModule.self)
    
    // æ³¨å†Œè®¢å•æ¨¡å—
    manager.register(OrderModule.self)
    
    print("âœ… æ‰€æœ‰æ¨¡å—å·²æ³¨å†Œ")
}
```

---

### 2. é¡µé¢è·³è½¬

#### æ–¹å¼1ï¼šé€šè¿‡ ModuleManagerï¼ˆæ¨èï¼‰

```swift
// æ‰“å¼€ç”¨æˆ·è¯¦æƒ…é¡µ
ModuleManager.shared.openPage(
    UserModule.self,
    parameters: ["userId": "12345"],
    from: self
)

// æ‰“å¼€å•†å“åˆ—è¡¨é¡µ
ModuleManager.shared.openPage(
    ProductModule.self,
    parameters: ["category": "ç”µå­äº§å“"],
    from: self
)
```

#### æ–¹å¼2ï¼šé€šè¿‡æ¨¡å—åè®®ï¼ˆç±»å‹å®‰å…¨ï¼‰

```swift
// è·å–ç”¨æˆ·æ¨¡å—
if let userModule = ModuleManager.shared.module(UserModule.self) {
    // åˆ›å»ºç”¨æˆ·è¯¦æƒ…é¡µ
    if let vc = userModule.createUserDetailPage(userId: "12345") {
        navigationController?.pushViewController(vc, animated: true)
    }
}
```

---

### 3. æœåŠ¡è°ƒç”¨ï¼ˆæ¨¡å—é—´é€šä¿¡ï¼‰

#### è·å–ç”¨æˆ·ä¿¡æ¯

```swift
// åœ¨ä»»ä½•åœ°æ–¹è°ƒç”¨ç”¨æˆ·æœåŠ¡
if let userModule = ModuleManager.shared.module(UserModule.self) {
    if let user = userModule.getCurrentUser() {
        print("å½“å‰ç”¨æˆ·ï¼š\(user.name)")
    }
}
```

#### è°ƒç”¨ç™»å½•æœåŠ¡

```swift
if let userModule = ModuleManager.shared.module(UserModule.self) {
    userModule.login(username: "zhangsan", password: "123456") { success in
        if success {
            print("âœ… ç™»å½•æˆåŠŸ")
        }
    }
}
```

#### è·å–å•†å“ä¿¡æ¯

```swift
if let productModule = ModuleManager.shared.module(ProductModule.self) {
    productModule.getProduct(productId: "8888") { product in
        if let product = product {
            print("å•†å“ï¼š\(product.name)ï¼Œä»·æ ¼ï¼š\(product.price)")
        }
    }
}
```

#### æ·»åŠ åˆ°è´­ç‰©è½¦

```swift
if let productModule = ModuleManager.shared.module(ProductModule.self) {
    let success = productModule.addToCart(productId: "8888", quantity: 2)
    print(success ? "âœ… å·²æ·»åŠ " : "âŒ æ·»åŠ å¤±è´¥")
}
```

---

### 4. è·¨æ¨¡å—é€šä¿¡ç¤ºä¾‹

#### åœºæ™¯ï¼šå•†å“è¯¦æƒ…é¡µè°ƒç”¨ç”¨æˆ·æœåŠ¡

```swift
class ProductDetailViewController: UIViewController {
    var productId: String?
    
    override func viewDidLoad() {
        super.viewDidLoad()
        
        // 1. è·å–å•†å“ä¿¡æ¯ï¼ˆæœ¬æ¨¡å—æœåŠ¡ï¼‰
        if let productModule = ModuleManager.shared.module(ProductModule.self) {
            productModule.getProduct(productId: productId ?? "") { [weak self] product in
                self?.displayProduct(product)
            }
        }
        
        // 2. è·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆè·¨æ¨¡å—è°ƒç”¨ï¼‰
        if let userModule = ModuleManager.shared.module(UserModule.self) {
            if let user = userModule.getCurrentUser() {
                print("å½“å‰ç”¨æˆ·ï¼š\(user.name)")
            }
        }
    }
    
    @objc func buyButtonTapped() {
        // 3. æ£€æŸ¥ç™»å½•çŠ¶æ€ï¼ˆè·¨æ¨¡å—è°ƒç”¨ï¼‰
        if let userModule = ModuleManager.shared.module(UserModule.self) {
            if userModule.getCurrentUser() != nil {
                // å·²ç™»å½•ï¼Œæ·»åŠ åˆ°è´­ç‰©è½¦
                addToCart()
            } else {
                // æœªç™»å½•ï¼Œè·³è½¬ç™»å½•é¡µ
                ModuleManager.shared.openPage(
                    UserModule.self,
                    parameters: [:],
                    from: self
                )
            }
        }
    }
}
```

---

## ğŸ”„ ä¸ç°æœ‰ URL Router å…±å­˜

### æ–¹æ¡ˆï¼šä¸¤ç§è·¯ç”±äº’è¡¥ä½¿ç”¨

```swift
/// ç»Ÿä¸€è·¯ç”±å…¥å£
class UnifiedRouter {
    
    /// æ‰“å¼€é¡µé¢ï¼ˆè‡ªåŠ¨é€‰æ‹©è·¯ç”±æ–¹å¼ï¼‰
    static func open(
        _ target: Any,
        parameters: [String: Any] = [:],
        from source: UIViewController? = nil
    ) -> Bool {
        
        // æ–¹å¼1ï¼šURL å­—ç¬¦ä¸² â†’ URL-Based Router
        if let urlString = target as? String {
            return Router.shared.open(urlString, parameters: parameters, from: source)
        }
        
        // æ–¹å¼2ï¼šæ¨¡å—ç±»å‹ â†’ Protocol-Based Router
        if let moduleType = target as? PageModuleProtocol.Type {
            return ModuleManager.shared.openPage(
                moduleType,
                parameters: parameters,
                from: source
            )
        }
        
        return false
    }
}

// ä½¿ç”¨ç¤ºä¾‹
UnifiedRouter.open("app://user/123")  // URL Router
UnifiedRouter.open(UserModule.self, parameters: ["userId": "123"])  // Protocol Router
```

---

## ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”æ€»ç»“

### URL-Based Router

**é€‚ç”¨åœºæ™¯ï¼š**
- âœ… å¤–éƒ¨å”¤èµ·ï¼ˆURL Schemeã€Universal Linksï¼‰
- âœ… H5 äº¤äº’ï¼ˆWebView è·³è½¬ï¼‰
- âœ… æ¨é€é€šçŸ¥è·³è½¬
- âœ… è¿è¥é…ç½®ï¼ˆè¿œç¨‹ä¸‹å‘ URLï¼‰
- âœ… åŠ¨æ€è·¯ç”±

**ç¤ºä¾‹ï¼š**
```swift
Router.shared.open("app://product/123?name=iPhone")
```

---

### Protocol-Based Router

**é€‚ç”¨åœºæ™¯ï¼š**
- âœ… åº”ç”¨å†…æ¨¡å—è·³è½¬
- âœ… æœåŠ¡è°ƒç”¨ï¼ˆæ¨¡å—é—´é€šä¿¡ï¼‰
- âœ… ç±»å‹å®‰å…¨è¦æ±‚é«˜
- âœ… å¤§å‹é¡¹ç›®ç»„ä»¶åŒ–
- âœ… éœ€è¦ç¼–è¯‘æ£€æŸ¥

**ç¤ºä¾‹ï¼š**
```swift
// é¡µé¢è·³è½¬
ModuleManager.shared.openPage(UserModule.self, parameters: ["userId": "123"])

// æœåŠ¡è°ƒç”¨
userModule.login(username: "zhangsan", password: "123")
```

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. é€‰æ‹©åˆé€‚çš„è·¯ç”±æ–¹å¼

```swift
// âœ… å¤–éƒ¨å”¤èµ·ï¼šä½¿ç”¨ URL Router
Router.shared.open("myapp://product/123")

// âœ… åº”ç”¨å†…è·³è½¬ï¼šä½¿ç”¨ Protocol Routerï¼ˆç±»å‹å®‰å…¨ï¼‰
ModuleManager.shared.openPage(ProductModule.self, parameters: ["productId": "123"])

// âœ… æœåŠ¡è°ƒç”¨ï¼šä½¿ç”¨ Protocol Router
let user = userModule.getCurrentUser()
```

### 2. æ¨¡å—åè®®è®¾è®¡

```swift
protocol UserModuleProtocol: PageModuleProtocol, ServiceModuleProtocol {
    // é¡µé¢ç›¸å…³
    func createUserDetailPage(userId: String) -> UIViewController?
    
    // æœåŠ¡ç›¸å…³
    func getCurrentUser() -> User?
    func login(...) -> Bool
}
```

### 3. æ¨¡å—ç‹¬ç«‹æ€§

```swift
// âœ… å¥½ï¼šé€šè¿‡åè®®è°ƒç”¨
if let userModule = ModuleManager.shared.module(UserModule.self) {
    let user = userModule.getCurrentUser()
}

// âŒ å·®ï¼šç›´æ¥ä¾èµ–æ¨¡å—
import UserModule  // ç´§è€¦åˆ
let user = UserManager.shared.getCurrentUser()
```

---

## ğŸ’¡ ç»„ä»¶åŒ–æ¶æ„ç¤ºä¾‹

### é¡¹ç›®ç»“æ„

```
MyApp/
â”œâ”€â”€ App/                    # ä¸»å·¥ç¨‹
â”‚   â”œâ”€â”€ AppDelegate.swift
â”‚   â””â”€â”€ ModuleRegister.swift
â”‚
â”œâ”€â”€ Protocols/              # åè®®å±‚
â”‚   â”œâ”€â”€ UserModuleProtocol.swift
â”‚   â”œâ”€â”€ ProductModuleProtocol.swift
â”‚   â””â”€â”€ OrderModuleProtocol.swift
â”‚
â”œâ”€â”€ UserModule/             # ç”¨æˆ·æ¨¡å—
â”‚   â”œâ”€â”€ UserModule.swift
â”‚   â”œâ”€â”€ UserDetailViewController.swift
â”‚   â””â”€â”€ UserListViewController.swift
â”‚
â”œâ”€â”€ ProductModule/          # å•†å“æ¨¡å—
â”‚   â”œâ”€â”€ ProductModule.swift
â”‚   â”œâ”€â”€ ProductDetailViewController.swift
â”‚   â””â”€â”€ ProductListViewController.swift
â”‚
â””â”€â”€ OrderModule/            # è®¢å•æ¨¡å—
    â”œâ”€â”€ OrderModule.swift
    â””â”€â”€ OrderListViewController.swift
```

---

## ğŸ” é«˜çº§ç‰¹æ€§

### 1. ä¾èµ–æ³¨å…¥

```swift
protocol NetworkServiceProtocol {
    func request(url: String, completion: @escaping (Data?) -> Void)
}

class ProductModule: ProductModuleProtocol {
    var networkService: NetworkServiceProtocol?
    
    func getProduct(productId: String, completion: @escaping (Product?) -> Void) {
        // ä½¿ç”¨æ³¨å…¥çš„ç½‘ç»œæœåŠ¡
        networkService?.request(url: "/products/\(productId)") { data in
            // å¤„ç†æ•°æ®
        }
    }
}
```

### 2. æ¨¡å—ç”Ÿå‘½å‘¨æœŸ

```swift
protocol ModuleLifecycleProtocol {
    func moduleDidLoad()
    func moduleWillAppear()
    func moduleDidDisappear()
}
```

### 3. æ¨¡å—é—´é€šçŸ¥

```swift
class ModuleNotificationCenter {
    static let shared = ModuleNotificationCenter()
    
    func post(event: String, data: [String: Any]) {
        // è·¨æ¨¡å—é€šçŸ¥
    }
    
    func addObserver(event: String, handler: @escaping ([String: Any]) -> Void) {
        // ç›‘å¬é€šçŸ¥
    }
}
```

---

## âœ… æ€»ç»“

### ä¸¤ç§è·¯ç”±å¯¹æ¯”

| ç‰¹æ€§ | URL-Based | Protocol-Based |
|------|-----------|----------------|
| ç±»å‹å®‰å…¨ | âŒ | âœ… |
| ç¼–è¯‘æ£€æŸ¥ | âŒ | âœ… |
| å¤–éƒ¨å”¤èµ· | âœ… | âŒ |
| æœåŠ¡è°ƒç”¨ | âŒ | âœ… |
| åŠ¨æ€é…ç½® | âœ… | âŒ |
| é€‚åˆåœºæ™¯ | å¤–éƒ¨äº¤äº’ | å†…éƒ¨é€šä¿¡ |

### æ¨èä½¿ç”¨

**å¤§å‹é¡¹ç›®ï¼šä¸¤ç§è·¯ç”±ç»“åˆä½¿ç”¨**

- **URL Router** â†’ å¤–éƒ¨å”¤èµ·ã€H5äº¤äº’ã€æ¨é€é€šçŸ¥
- **Protocol Router** â†’ åº”ç”¨å†…è·³è½¬ã€æ¨¡å—é€šä¿¡ã€æœåŠ¡è°ƒç”¨

**å°å‹é¡¹ç›®ï¼šå•ä¸€è·¯ç”±å³å¯**

- URL Router æ›´çµæ´»
- Protocol Router æ›´å®‰å…¨

---

**æ¥ä¸‹æ¥æˆ‘å°†å®ç°å®Œæ•´çš„ä»£ç ï¼ğŸš€**

