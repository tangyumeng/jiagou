# å¦‚ä½•è¿è¡Œ EventBus æ¼”ç¤º

## âœ… å·²å®Œæˆçš„é›†æˆ

EventBus æ¼”ç¤ºå·²ç»é›†æˆåˆ°ç°æœ‰çš„ä¸‹è½½ç®¡ç†å™¨é¡¹ç›®ä¸­ï¼

---

## ğŸš€ è¿è¡Œæ­¥éª¤

### 1. æ‰“å¼€é¡¹ç›®
```bash
cd /Users/tangyumeng/Documents/ios-learn/jiagou
open jiagou.xcodeproj
```

### 2. è¿è¡Œé¡¹ç›®
```bash
âŒ˜ + R (Command + R)
```

### 3. æ‰“å¼€ EventBus æ¼”ç¤º
åœ¨ä¸‹è½½ç®¡ç†å™¨é¡µé¢ï¼Œç‚¹å‡»å³ä¸Šè§’çš„ **"EventBus"** æŒ‰é’®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ < å¤šä»»åŠ¡ä¸‹è½½å™¨    [EventBus] [+] â”‚  â† ç‚¹å‡»è¿™é‡Œ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä»»åŠ¡åˆ—è¡¨...                     â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“± ç•Œé¢å¸ƒå±€

```
ä¸‹è½½ç®¡ç†å™¨é¡µé¢ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [æ¸…é™¤å·²å®Œæˆ]  å¤šä»»åŠ¡ä¸‹è½½å™¨  [EventBus] [+] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“„ file1.zip                        â”‚
â”‚  â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 45%                â”‚
â”‚  â¬‡ï¸ 1.2 MB/s                        â”‚
â”‚                                     â”‚
â”‚  ğŸ“„ file2.pdf                        â”‚
â”‚  â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ 100%               â”‚
â”‚  âœ… å·²å®Œæˆ                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“ ç‚¹å‡» EventBus
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ < EventBus æ¼”ç¤º                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ—¥å¿—æ˜¾ç¤ºåŒºåŸŸ                         â”‚
â”‚  [10:30:45] âœ… EventBus ç¤ºä¾‹å·²å¯åŠ¨    â”‚
â”‚  [10:30:45] ğŸ“ å·²è®¢é˜…æ‰€æœ‰äº‹ä»¶         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¦ ä¸‹è½½äº‹ä»¶                          â”‚
â”‚  [å‘å¸ƒï¼šä¸‹è½½å®Œæˆäº‹ä»¶]                 â”‚
â”‚  [å‘å¸ƒï¼šä¸‹è½½è¿›åº¦äº‹ä»¶]                 â”‚
â”‚                                     â”‚
â”‚  ğŸ›’ è®¢å•äº‹ä»¶                          â”‚
â”‚  [å‘å¸ƒï¼šè®¢å•åˆ›å»ºäº‹ä»¶]                 â”‚
â”‚  [å‘å¸ƒï¼šå¤šä¸ªè®¢å•äº‹ä»¶]                 â”‚
â”‚                                     â”‚
â”‚  ğŸ¨ ä¸»é¢˜äº‹ä»¶                          â”‚
â”‚  [å‘å¸ƒï¼šä¸»é¢˜åˆ‡æ¢äº‹ä»¶]                 â”‚
â”‚                                     â”‚
â”‚  [æ¸…é™¤æ—¥å¿—]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ åŠŸèƒ½æµ‹è¯•

### 1. æµ‹è¯•ä¸‹è½½äº‹ä»¶
- ç‚¹å‡» **"å‘å¸ƒï¼šä¸‹è½½å®Œæˆäº‹ä»¶"** 
- è§‚å¯Ÿæ—¥å¿—è¾“å‡ºï¼šæ–‡ä»¶åã€æ–‡ä»¶å¤§å°

### 2. æµ‹è¯•ä¸‹è½½è¿›åº¦
- ç‚¹å‡» **"å‘å¸ƒï¼šä¸‹è½½è¿›åº¦äº‹ä»¶"**
- è§‚å¯Ÿè¿›åº¦ç™¾åˆ†æ¯”å˜åŒ–

### 3. æµ‹è¯•è®¢å•äº‹ä»¶
- ç‚¹å‡» **"å‘å¸ƒï¼šè®¢å•åˆ›å»ºäº‹ä»¶"**
- è§‚å¯Ÿè®¢å•ä¿¡æ¯ï¼šIDã€å•†å“ã€é‡‘é¢

### 4. æµ‹è¯•æ‰¹é‡äº‹ä»¶
- ç‚¹å‡» **"å‘å¸ƒï¼šå¤šä¸ªè®¢å•äº‹ä»¶"**
- è§‚å¯Ÿå»¶è¿Ÿå‘å¸ƒæ•ˆæœï¼ˆæ¯éš” 0.5 ç§’ï¼‰

### 5. æµ‹è¯•ä¸»é¢˜åˆ‡æ¢
- ç‚¹å‡» **"å‘å¸ƒï¼šä¸»é¢˜åˆ‡æ¢äº‹ä»¶"**
- è§‚å¯Ÿç•Œé¢é¢œè‰²å˜åŒ–ï¼ˆæ·±è‰²/æµ…è‰²ï¼‰

---

## ğŸ“ ä»£ç å˜æ›´è¯´æ˜

### ViewController.swift çš„å˜æ›´

```swift
// 1. æ·»åŠ äº† EventBus æŒ‰é’®
private lazy var eventBusButton: UIBarButtonItem = {
    return UIBarButtonItem(title: "EventBus", style: .plain, target: self, action: #selector(openEventBusDemo))
}()

// 2. å¯¼èˆªæ å³ä¾§æ”¹ä¸ºæŒ‰é’®æ•°ç»„
navigationItem.rightBarButtonItems = [addButton, eventBusButton]

// 3. æ·»åŠ äº†æ‰“å¼€ EventBus æ¼”ç¤ºçš„æ–¹æ³•
@objc private func openEventBusDemo() {
    let eventBusVC = EventBusExampleViewController()
    navigationController?.pushViewController(eventBusVC, animated: true)
}
```

### æ–°å¢æ–‡ä»¶

1. **EventBusExample.swift** - EventBus å®Œæ•´æ¼”ç¤ºä»£ç 
2. **EventBusä½¿ç”¨è¯´æ˜.md** - è¯¦ç»†ä½¿ç”¨æ–‡æ¡£
3. **EventBuså¿«é€Ÿå¯åŠ¨.md** - å¿«é€Ÿå¯åŠ¨æŒ‡å—

---

## ğŸ” éªŒè¯æ¸…å•

è¿è¡Œå‰æ£€æŸ¥ï¼š
- [x] EventBusExample.swift å·²æ·»åŠ åˆ°é¡¹ç›®
- [x] ViewController.swift å·²ä¿®æ”¹
- [x] é¡¹ç›®å¯ä»¥æˆåŠŸç¼–è¯‘
- [x] æ— ç¼–è¯‘é”™è¯¯

è¿è¡Œåæ£€æŸ¥ï¼š
- [ ] ä¸‹è½½ç®¡ç†å™¨é¡µé¢æ­£å¸¸æ˜¾ç¤º
- [ ] å³ä¸Šè§’æœ‰ "EventBus" æŒ‰é’®
- [ ] ç‚¹å‡»æŒ‰é’®å¯ä»¥æ‰“å¼€ EventBus æ¼”ç¤ºé¡µé¢
- [ ] æ¼”ç¤ºé¡µé¢æ˜¾ç¤ºæ—¥å¿—åŒºåŸŸå’ŒæŒ‰é’®
- [ ] ç‚¹å‡»æŒ‰é’®æœ‰æ—¥å¿—è¾“å‡º

---

## ğŸ’¡ å¸¸è§é—®é¢˜

### Q1: æ‰¾ä¸åˆ° EventBus æŒ‰é’®ï¼Ÿ
**A:** æ£€æŸ¥æ˜¯å¦åœ¨ NavigationController ä¸­ï¼ŒEventBus æŒ‰é’®åœ¨å¯¼èˆªæ å³ä¸Šè§’

### Q2: ç‚¹å‡»æŒ‰é’®æ²¡ååº”ï¼Ÿ
**A:** æ£€æŸ¥ EventBusExample.swift æ˜¯å¦å·²æ·»åŠ åˆ°é¡¹ç›® Target

### Q3: ç¼–è¯‘é”™è¯¯ï¼Ÿ
**A:** ç¡®ä¿æ‰€æœ‰æ–‡ä»¶éƒ½å·²æ·»åŠ åˆ°æ­£ç¡®çš„ Targetï¼ŒClean Build Folder åé‡æ–°ç¼–è¯‘

### Q4: æ‰¾ä¸åˆ° EventBusExampleViewControllerï¼Ÿ
**A:** æ£€æŸ¥ EventBusExample.swift æ˜¯å¦åœ¨é¡¹ç›®ä¸­ï¼Œå¹¶ä¸”å·²å‹¾é€‰æ­£ç¡®çš„ Target Membership

---

## ğŸ¤ é¢è¯•æ¼”ç¤ºå»ºè®®

### æ¼”ç¤ºæµç¨‹ï¼ˆ5åˆ†é’Ÿï¼‰

1. **ä»‹ç»èƒŒæ™¯**ï¼ˆ30ç§’ï¼‰
   - "è¿™æ˜¯æˆ‘å®ç°çš„ EventBus æ¶ˆæ¯é€šä¿¡æ¡†æ¶"
   - "ç”¨äºè§£å†³æ¨¡å—é—´è§£è€¦é€šä¿¡é—®é¢˜"

2. **å±•ç¤ºåŠŸèƒ½**ï¼ˆ2åˆ†é’Ÿï¼‰
   - ç‚¹å‡»"ä¸‹è½½å®Œæˆäº‹ä»¶" â†’ å±•ç¤ºç±»å‹å®‰å…¨çš„äº‹ä»¶
   - ç‚¹å‡»"å¤šä¸ªè®¢å•äº‹ä»¶" â†’ å±•ç¤ºä¸€å¯¹å¤šé€šä¿¡
   - ç‚¹å‡»"ä¸»é¢˜åˆ‡æ¢" â†’ å±•ç¤ºå®æ—¶å“åº”

3. **è®²è§£ä»£ç **ï¼ˆ2åˆ†é’Ÿï¼‰
   - æ‰“å¼€ EventBus.swift â†’ è®²è§£æ ¸å¿ƒå®ç°
   - æŒ‡å‡ºçº¿ç¨‹å®‰å…¨çš„å¤„ç†
   - æŒ‡å‡ºå†…å­˜ç®¡ç†ï¼ˆweak å¼•ç”¨ï¼‰

4. **å›ç­”è¿½é—®**ï¼ˆ30ç§’ï¼‰
   - EventBus vs NotificationCenter
   - å¦‚ä½•é¿å…å¾ªç¯å¼•ç”¨
   - é€‚ç”¨åœºæ™¯

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **EventBus.swift** - æ ¸å¿ƒå®ç°ï¼ˆ200è¡Œï¼‰
- **EventBusExample.swift** - å®Œæ•´æ¼”ç¤ºï¼ˆ500è¡Œï¼‰
- **EventBusä½¿ç”¨è¯´æ˜.md** - è¯¦ç»†æ–‡æ¡£
- **EventBuså¿«é€Ÿå¯åŠ¨.md** - å¿«é€Ÿå…¥é—¨

---

## ğŸ‰ æ€»ç»“

âœ… **é›†æˆå®Œæˆ** - EventBus æ¼”ç¤ºå·²æ·»åŠ åˆ°é¡¹ç›®  
âœ… **ä¸€é”®å¯åŠ¨** - ç‚¹å‡»å¯¼èˆªæ æŒ‰é’®å³å¯æ‰“å¼€  
âœ… **åŠŸèƒ½å®Œæ•´** - åŒ…å«æ‰€æœ‰æ ¸å¿ƒç‰¹æ€§æ¼”ç¤º  
âœ… **æ–‡æ¡£å®Œå–„** - æä¾›è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜  

**ç«‹å³è¿è¡Œé¡¹ç›®ï¼Œä½“éªŒ EventBus çš„å¼ºå¤§åŠŸèƒ½ï¼ğŸš€**

---

## ğŸ¯ ä¸‹ä¸€æ­¥

### å¯é€‰æ‰©å±•

1. **é›†æˆåˆ°ä¸‹è½½ç®¡ç†å™¨**
   ```swift
   // åœ¨ DownloadManager ä¸­å‘å¸ƒäº‹ä»¶
   EventBus.shared.post(DownloadCompletedEvent(...))
   ```

2. **æ·»åŠ æ›´å¤šäº‹ä»¶**
   ```swift
   struct NetworkStatusEvent: Event { ... }
   struct UserLoginEvent: Event { ... }
   ```

3. **åˆ›å»ºæœåŠ¡ç›‘å¬**
   ```swift
   class StatisticsService {
       init() {
           EventBus.shared.subscribe(...) { ... }
       }
   }
   ```

**ç°åœ¨å°±è¿è¡Œé¡¹ç›®ï¼Œå¼€å§‹ä½ çš„ EventBus ä¹‹æ—…ï¼ğŸ’ª**

