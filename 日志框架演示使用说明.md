# æ—¥å¿—æ¡†æ¶æ¼”ç¤ºä½¿ç”¨è¯´æ˜

## ğŸ“ åŠŸèƒ½æ¦‚è¿°

æœ¬é¡¹ç›®åŒ…å«å®Œæ•´çš„æ—¥å¿—æ¡†æ¶å®ç°ï¼Œæä¾›å¤šçº§åˆ«ã€å¤šè¾“å‡ºç›®æ ‡çš„æ—¥å¿—ç³»ç»Ÿï¼Œé€‚ç”¨äºä¼ä¸šçº§åº”ç”¨å¼€å‘ã€‚

**æ ¸å¿ƒç‰¹æ€§**:
- âœ… å…­ç§æ—¥å¿—çº§åˆ«ï¼ˆVERBOSEã€DEBUGã€INFOã€WARNINGã€ERRORã€FATALï¼‰
- âœ… å¤šè¾“å‡ºç›®æ ‡ï¼ˆæ§åˆ¶å°ã€æ–‡ä»¶ã€è¿œç¨‹æœåŠ¡å™¨ï¼‰
- âœ… è‡ªå®šä¹‰æ—¥å¿—æ ¼å¼åŒ–å™¨
- âœ… æ—¥å¿—æ–‡ä»¶è½®è½¬ï¼ˆè‡ªåŠ¨ç®¡ç†æ–‡ä»¶å¤§å°ï¼‰
- âœ… çº¿ç¨‹å®‰å…¨
- âœ… ä¸°å¯Œçš„å…ƒæ•°æ®ï¼ˆæ—¶é—´æˆ³ã€æ–‡ä»¶åã€è¡Œå·ã€çº¿ç¨‹ä¿¡æ¯ï¼‰

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### ä»ä¸»é¡µè¿›å…¥

1. è¿è¡Œé¡¹ç›®
2. åœ¨ä¸»é¡µæ‰¾åˆ° **"æ—¥å¿—æ¡†æ¶"** æŒ‰é’®ï¼ˆç»¿è‰²ï¼‰
3. ç‚¹å‡»è¿›å…¥æ—¥å¿—æ¡†æ¶æ¼”ç¤ºç•Œé¢

### ä»£ç å¯åŠ¨

```swift
let loggerVC = LoggerDemoViewController()
navigationController?.pushViewController(loggerVC, animated: true)
```

---

## ğŸ“Š åŠŸèƒ½æ¼”ç¤º

### 1. æ—¥å¿—çº§åˆ«æ¼”ç¤º

ç‚¹å‡»ä¸åŒçš„æŒ‰é’®è®°å½•ä¸åŒçº§åˆ«çš„æ—¥å¿—ï¼š

| æŒ‰é’® | æ—¥å¿—çº§åˆ« | ä½¿ç”¨åœºæ™¯ | é¢œè‰² |
|------|---------|---------|------|
| ğŸ’¬ VERBOSE | è¯¦ç»†æ—¥å¿— | å¼€å‘è°ƒè¯•ã€è¯¦ç»†è¿½è¸ª | ç°è‰² |
| ğŸ› DEBUG | è°ƒè¯•æ—¥å¿— | å¼€å‘ç¯å¢ƒã€é—®é¢˜æ’æŸ¥ | è“è‰² |
| â„¹ï¸ INFO | ä¿¡æ¯æ—¥å¿— | æ­£å¸¸ä¿¡æ¯ã€å…³é”®æ­¥éª¤ | ç»¿è‰² |
| âš ï¸ WARNING | è­¦å‘Šæ—¥å¿— | æ½œåœ¨é—®é¢˜ã€æ€§èƒ½è­¦å‘Š | é»„è‰² |
| âŒ ERROR | é”™è¯¯æ—¥å¿— | é”™è¯¯ä¿¡æ¯ã€å¼‚å¸¸æ•è· | çº¢è‰² |
| ğŸ’€ FATAL | è‡´å‘½é”™è¯¯ | ä¸¥é‡é”™è¯¯ã€å´©æºƒå‰ | ç´«è‰² |

### 2. åŠŸèƒ½æŒ‰é’®

| æŒ‰é’® | åŠŸèƒ½è¯´æ˜ |
|------|---------|
| ğŸ—‘ï¸ æ¸…é™¤æ—¥å¿— | æ¸…ç©ºæ˜¾ç¤ºåŒºåŸŸçš„æ—¥å¿—å†…å®¹ |
| ğŸ’¾ ä¿å­˜åˆ°æ–‡ä»¶ | å¯ç”¨æ–‡ä»¶æ—¥å¿—è¾“å‡ºï¼Œæ—¥å¿—ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ |

---

## ğŸ—ï¸ æ¶æ„è¯´æ˜

### æ ¸å¿ƒç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Logger                   â”‚
â”‚         (æ—¥å¿—ç®¡ç†å™¨)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ åˆ†å‘æ—¥å¿—
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        LogDestination               â”‚
â”‚      (æ—¥å¿—è¾“å‡ºç›®æ ‡åè®®)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ ConsoleLogDestination (æ§åˆ¶å°)   â”‚
â”‚  â€¢ FileLogDestination (æ–‡ä»¶)        â”‚
â”‚  â€¢ RemoteLogDestination (è¿œç¨‹)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ æ ¼å¼åŒ–
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        LogFormatter                 â”‚
â”‚      (æ—¥å¿—æ ¼å¼åŒ–å™¨åè®®)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ DefaultLogFormatter (é»˜è®¤)       â”‚
â”‚  â€¢ SimpleLogFormatter (ç®€å•)        â”‚
â”‚  â€¢ JSONLogFormatter (JSON)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’» ä»£ç ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ä½¿ç”¨

```swift
// 1. è®°å½•ä¸åŒçº§åˆ«çš„æ—¥å¿—
logVerbose("è¯¦ç»†ä¿¡æ¯ï¼šå˜é‡ x = 10")
logDebug("å¼€å§‹å¤„ç†ç”¨æˆ·è¯·æ±‚")
logInfo("ç”¨æˆ·ç™»å½•æˆåŠŸï¼šuser_id = 123")
logWarning("ç½‘ç»œè¿æ¥ä¸ç¨³å®š")
logError("æ–‡ä»¶è¯»å–å¤±è´¥ï¼šfile not found")
logFatal("æ•°æ®åº“è¿æ¥ä¸¢å¤±")

// 2. ä½¿ç”¨ Logger å•ä¾‹
Logger.shared.verbose("è¯¦ç»†æ—¥å¿—")
Logger.shared.debug("è°ƒè¯•æ—¥å¿—")
Logger.shared.info("ä¿¡æ¯æ—¥å¿—")
Logger.shared.warning("è­¦å‘Šæ—¥å¿—")
Logger.shared.error("é”™è¯¯æ—¥å¿—")
Logger.shared.fatal("è‡´å‘½é”™è¯¯")
```

### è‡ªå®šä¹‰é…ç½®

```swift
// 1. è®¾ç½®å…¨å±€æœ€ä½æ—¥å¿—çº§åˆ«
Logger.shared.minLevel = .info  // åªè¾“å‡º INFO åŠä»¥ä¸Šçº§åˆ«

// 2. æ·»åŠ æ–‡ä»¶è¾“å‡º
let fileDestination = FileLogDestination()
fileDestination.minLevel = .warning  // åªä¿å­˜è­¦å‘ŠåŠä»¥ä¸Šçº§åˆ«åˆ°æ–‡ä»¶
Logger.shared.addDestination(fileDestination)

// 3. æ·»åŠ è¿œç¨‹æ—¥å¿—è¾“å‡º
let remoteDestination = RemoteLogDestination(
    serverURL: "https://api.example.com/logs"
)
remoteDestination.minLevel = .error  // åªä¸ŠæŠ¥é”™è¯¯åˆ°æœåŠ¡å™¨
Logger.shared.addDestination(remoteDestination)

// 4. è‡ªå®šä¹‰æ ¼å¼åŒ–å™¨
let simpleFormatter = SimpleLogFormatter()
let consoleDestination = ConsoleLogDestination()
consoleDestination.formatter = simpleFormatter
```

### æ—¥å¿—è¾“å‡ºæ ¼å¼

#### é»˜è®¤æ ¼å¼åŒ–å™¨ (DefaultLogFormatter)

```
[2025-10-16 18:30:45.123] [â„¹ï¸ INFO] [main] [HomeViewController.swift:42 viewDidLoad()] ç”¨æˆ·ç™»å½•æˆåŠŸ
```

åŒ…å«ä¿¡æ¯ï¼š
- æ—¶é—´æˆ³ï¼ˆç²¾ç¡®åˆ°æ¯«ç§’ï¼‰
- æ—¥å¿—çº§åˆ«ï¼ˆå›¾æ ‡ + åç§°ï¼‰
- çº¿ç¨‹ä¿¡æ¯
- æ–‡ä»¶åå’Œè¡Œå·
- å‡½æ•°å
- æ—¥å¿—æ¶ˆæ¯

#### ç®€å•æ ¼å¼åŒ–å™¨ (SimpleLogFormatter)

```
â„¹ï¸ [INFO] ç”¨æˆ·ç™»å½•æˆåŠŸ
```

é€‚ç”¨äºï¼š
- ç”Ÿäº§ç¯å¢ƒ
- ç®€æ´è¾“å‡º
- ç”¨æˆ·å¯è§æ—¥å¿—

#### JSON æ ¼å¼åŒ–å™¨ (JSONLogFormatter)

```json
{
  "level": "INFO",
  "message": "ç”¨æˆ·ç™»å½•æˆåŠŸ",
  "file": "HomeViewController.swift",
  "function": "viewDidLoad()",
  "line": 42,
  "timestamp": 1697462445.123,
  "thread": "main"
}
```

é€‚ç”¨äºï¼š
- æ—¥å¿—ä¸ŠæŠ¥
- ç»“æ„åŒ–å­˜å‚¨
- æ—¥å¿—åˆ†æ

---

## ğŸ”§ é«˜çº§åŠŸèƒ½

### 1. æ–‡ä»¶æ—¥å¿—ç®¡ç†

**è‡ªåŠ¨è½®è½¬**:
- å•ä¸ªæ–‡ä»¶æœ€å¤§ 5MB
- è¶…è¿‡å¤§å°è‡ªåŠ¨åˆ›å»ºæ–°æ–‡ä»¶
- æ—§æ–‡ä»¶å¸¦æ—¶é—´æˆ³é‡å‘½å

**æ–‡ä»¶æ¸…ç†**:
- æœ€å¤šä¿ç•™ 10 ä¸ªæ—¥å¿—æ–‡ä»¶
- è‡ªåŠ¨åˆ é™¤æœ€æ—§çš„æ–‡ä»¶
- é¿å…å ç”¨è¿‡å¤šå­˜å‚¨ç©ºé—´

**æ–‡ä»¶è·¯å¾„**:
```
Documents/Logs/
  â”œâ”€â”€ app_2025-10-16.log          (å½“å‰æ—¥å¿—)
  â”œâ”€â”€ app_2025-10-16_1697460000.log (å·²è½®è½¬)
  â”œâ”€â”€ app_2025-10-15.log
  â””â”€â”€ ...
```

### 2. è¿œç¨‹æ—¥å¿—ä¸ŠæŠ¥

**ç¼“å†²æœºåˆ¶**:
- ç¼“å†² 10 æ¡æ—¥å¿—åæ‰¹é‡ä¸ŠæŠ¥
- å‡å°‘ç½‘ç»œè¯·æ±‚æ¬¡æ•°
- æ”¯æŒç«‹å³åˆ·æ–° `flush()`

**ä¸ŠæŠ¥é€»è¾‘**:
```swift
// åªä¸ŠæŠ¥ ERROR å’Œ FATAL çº§åˆ«
remoteDestination.minLevel = .error

// æ‰‹åŠ¨è§¦å‘ä¸ŠæŠ¥
remoteDestination.flush()
```

### 3. çº¿ç¨‹å®‰å…¨

**å®ç°æ–¹å¼**:
```swift
private let queue = DispatchQueue(
    label: "com.jiagou.logger",
    qos: .utility,
    attributes: .concurrent
)
```

**ç‰¹ç‚¹**:
- è¯»æ“ä½œä½¿ç”¨ `sync`
- å†™æ“ä½œä½¿ç”¨ `async(flags: .barrier)`
- ä¿è¯å¤šçº¿ç¨‹ç¯å¢ƒä¸‹æ•°æ®å®‰å…¨

### 4. å…ƒæ•°æ®è‡ªåŠ¨æ•è·

ä½¿ç”¨ Swift çš„ç¼–è¯‘æ—¶å®ï¼š

```swift
func logInfo(
    _ message: String,
    file: String = #file,      // è‡ªåŠ¨æ•è·æ–‡ä»¶å
    function: String = #function,  // è‡ªåŠ¨æ•è·å‡½æ•°å
    line: Int = #line          // è‡ªåŠ¨æ•è·è¡Œå·
)
```

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šå¼€å‘è°ƒè¯•

```swift
func processUserData(_ data: [String: Any]) {
    logDebug("å¼€å§‹å¤„ç†ç”¨æˆ·æ•°æ®")
    logVerbose("åŸå§‹æ•°æ®ï¼š\(data)")
    
    guard let userId = data["id"] as? String else {
        logError("ç”¨æˆ·IDç¼ºå¤±")
        return
    }
    
    logInfo("å¤„ç†ç”¨æˆ· ID: \(userId)")
}
```

### åœºæ™¯2ï¼šé”™è¯¯è¿½è¸ª

```swift
func downloadFile(url: URL) {
    do {
        let data = try Data(contentsOf: url)
        logInfo("æ–‡ä»¶ä¸‹è½½æˆåŠŸï¼š\(url.lastPathComponent)")
    } catch {
        logError("æ–‡ä»¶ä¸‹è½½å¤±è´¥ï¼š\(error.localizedDescription)")
        logError("URL: \(url.absoluteString)")
    }
}
```

### åœºæ™¯3ï¼šæ€§èƒ½ç›‘æ§

```swift
func performHeavyTask() {
    let startTime = Date()
    logInfo("å¼€å§‹æ‰§è¡Œé‡ä»»åŠ¡")
    
    // æ‰§è¡Œä»»åŠ¡
    heavyComputation()
    
    let duration = Date().timeIntervalSince(startTime)
    if duration > 1.0 {
        logWarning("ä»»åŠ¡æ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼š\(duration)ç§’")
    } else {
        logInfo("ä»»åŠ¡å®Œæˆï¼Œè€—æ—¶ï¼š\(duration)ç§’")
    }
}
```

### åœºæ™¯4ï¼šç”Ÿäº§ç¯å¢ƒç›‘æ§

```swift
// AppDelegate ä¸­é…ç½®
func application(_ application: UIApplication, didFinishLaunchingWithOptions...) {
    // é…ç½®æ—¥å¿—ç³»ç»Ÿ
    #if DEBUG
    Logger.shared.minLevel = .verbose
    #else
    Logger.shared.minLevel = .warning  // ç”Ÿäº§ç¯å¢ƒåªè®°å½•è­¦å‘ŠåŠä»¥ä¸Š
    
    // æ·»åŠ æ–‡ä»¶æ—¥å¿—
    let fileDestination = FileLogDestination()
    Logger.shared.addDestination(fileDestination)
    
    // æ·»åŠ è¿œç¨‹æ—¥å¿—ï¼ˆåªä¸ŠæŠ¥é”™è¯¯ï¼‰
    let remoteDestination = RemoteLogDestination(
        serverURL: "https://api.yourserver.com/logs"
    )
    remoteDestination.minLevel = .error
    Logger.shared.addDestination(remoteDestination)
    #endif
    
    logInfo("åº”ç”¨å¯åŠ¨æˆåŠŸ")
}
```

---

## ğŸ“š API æ–‡æ¡£

### Logger ç±»

**å•ä¾‹è®¿é—®**:
```swift
Logger.shared
```

**æ–¹æ³•**:

| æ–¹æ³• | è¯´æ˜ |
|------|------|
| `verbose(_ message:)` | è®°å½•è¯¦ç»†æ—¥å¿— |
| `debug(_ message:)` | è®°å½•è°ƒè¯•æ—¥å¿— |
| `info(_ message:)` | è®°å½•ä¿¡æ¯æ—¥å¿— |
| `warning(_ message:)` | è®°å½•è­¦å‘Šæ—¥å¿— |
| `error(_ message:)` | è®°å½•é”™è¯¯æ—¥å¿— |
| `fatal(_ message:)` | è®°å½•è‡´å‘½é”™è¯¯ |
| `addDestination(_ destination:)` | æ·»åŠ è¾“å‡ºç›®æ ‡ |
| `removeAllDestinations()` | ç§»é™¤æ‰€æœ‰è¾“å‡ºç›®æ ‡ |

**å±æ€§**:

| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `minLevel` | `LogLevel` | å…¨å±€æœ€ä½æ—¥å¿—çº§åˆ« |

### LogDestination åè®®

**å®ç°ç±»**:
- `ConsoleLogDestination` - æ§åˆ¶å°è¾“å‡º
- `FileLogDestination` - æ–‡ä»¶è¾“å‡º
- `RemoteLogDestination` - è¿œç¨‹ä¸ŠæŠ¥

**å±æ€§**:

| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `minLevel` | `LogLevel` | è¯¥ç›®æ ‡çš„æœ€ä½æ—¥å¿—çº§åˆ« |
| `formatter` | `LogFormatter` | æ—¥å¿—æ ¼å¼åŒ–å™¨ |

### FileLogDestination ç‰¹æœ‰æ–¹æ³•

| æ–¹æ³• | è¯´æ˜ |
|------|------|
| `getAllLogFiles() -> [URL]` | è·å–æ‰€æœ‰æ—¥å¿—æ–‡ä»¶ |
| `clearAllLogs()` | æ¸…ç©ºæ‰€æœ‰æ—¥å¿—æ–‡ä»¶ |

### RemoteLogDestination ç‰¹æœ‰æ–¹æ³•

| æ–¹æ³• | è¯´æ˜ |
|------|------|
| `flush()` | ç«‹å³ä¸ŠæŠ¥ç¼“å†²çš„æ—¥å¿— |

---

## ğŸ¨ æ¼”ç¤ºç•Œé¢è¯´æ˜

### ä¸»ç•Œé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        æ—¥å¿—æ¡†æ¶åŠŸèƒ½æ¼”ç¤º               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ—¥å¿—æ˜¾ç¤ºåŒºåŸŸ                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ [18:30:45] ğŸ’¬ [VERBOSE] ...   â”‚  â”‚
â”‚  â”‚ [18:30:46] ğŸ› [DEBUG] ...     â”‚  â”‚
â”‚  â”‚ [18:30:47] â„¹ï¸ [INFO] ...      â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ ğŸ’¬ è®°å½• VERBOSE æ—¥å¿— ]            â”‚
â”‚  [ ğŸ› è®°å½• DEBUG æ—¥å¿— ]              â”‚
â”‚  [ â„¹ï¸ è®°å½• INFO æ—¥å¿— ]               â”‚
â”‚  [ âš ï¸ è®°å½• WARNING æ—¥å¿— ]            â”‚
â”‚  [ âŒ è®°å½• ERROR æ—¥å¿— ]              â”‚
â”‚  [ ğŸ’€ è®°å½• FATAL æ—¥å¿— ]              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ ğŸ—‘ï¸ æ¸…é™¤æ—¥å¿— ]                    â”‚
â”‚  [ ğŸ’¾ ä¿å­˜åˆ°æ–‡ä»¶ ]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ“ä½œè¯´æ˜

1. **è®°å½•æ—¥å¿—**: ç‚¹å‡»å¯¹åº”çº§åˆ«çš„æŒ‰é’®ï¼Œä¼šåœ¨æ˜¾ç¤ºåŒºåŸŸå’Œæ§åˆ¶å°è¾“å‡ºæ—¥å¿—
2. **æ¸…é™¤æ—¥å¿—**: æ¸…ç©ºæ˜¾ç¤ºåŒºåŸŸçš„å†…å®¹ï¼ˆä¸å½±å“å·²ä¿å­˜çš„æ–‡ä»¶æ—¥å¿—ï¼‰
3. **ä¿å­˜åˆ°æ–‡ä»¶**: å¯ç”¨æ–‡ä»¶æ—¥å¿—è¾“å‡ºï¼Œåç»­æ—¥å¿—ä¼šä¿å­˜åˆ° `Documents/Logs/` ç›®å½•

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. æ—¥å¿—çº§åˆ«é€‰æ‹©

**VERBOSE**:
```swift
logVerbose("å¾ªç¯ç¬¬ \(i) æ¬¡ï¼Œå½“å‰å€¼ï¼š\(value)")
```
- ç”¨äºï¼šè¯¦ç»†çš„æ‰§è¡Œæµç¨‹
- åœºæ™¯ï¼šç®—æ³•è°ƒè¯•ã€æ•°æ®è¿½è¸ª

**DEBUG**:
```swift
logDebug("è¿›å…¥ viewDidLoad æ–¹æ³•")
logDebug("ç½‘ç»œè¯·æ±‚å‚æ•°ï¼š\(params)")
```
- ç”¨äºï¼šå¼€å‘è°ƒè¯•ä¿¡æ¯
- åœºæ™¯ï¼šå¼€å‘ç¯å¢ƒã€é—®é¢˜æ’æŸ¥

**INFO**:
```swift
logInfo("ç”¨æˆ·ç™»å½•æˆåŠŸï¼š\(username)")
logInfo("ä¸‹è½½å®Œæˆï¼š\(fileName)")
```
- ç”¨äºï¼šé‡è¦ä¿¡æ¯è®°å½•
- åœºæ™¯ï¼šå…³é”®æ“ä½œã€ä¸šåŠ¡æµç¨‹

**WARNING**:
```swift
logWarning("ç½‘ç»œè¿æ¥ä¸ç¨³å®š")
logWarning("å†…å­˜ä½¿ç”¨ç‡ï¼š\(usage)%")
```
- ç”¨äºï¼šæ½œåœ¨é—®é¢˜æç¤º
- åœºæ™¯ï¼šæ€§èƒ½è­¦å‘Šã€å…¼å®¹æ€§æé†’

**ERROR**:
```swift
logError("æ–‡ä»¶è¯»å–å¤±è´¥ï¼š\(error)")
logError("API è¯·æ±‚å¤±è´¥ï¼š\(statusCode)")
```
- ç”¨äºï¼šé”™è¯¯ä¿¡æ¯è®°å½•
- åœºæ™¯ï¼šå¼‚å¸¸å¤„ç†ã€é”™è¯¯è¿½è¸ª

**FATAL**:
```swift
logFatal("æ•°æ®åº“åˆå§‹åŒ–å¤±è´¥ï¼Œåº”ç”¨æ— æ³•ç»§ç»­")
logFatal("å…³é”®é…ç½®æ–‡ä»¶ä¸¢å¤±")
```
- ç”¨äºï¼šè‡´å‘½é”™è¯¯è®°å½•
- åœºæ™¯ï¼šåº”ç”¨å´©æºƒå‰ã€ä¸¥é‡é”™è¯¯

### 2. ç”Ÿäº§ç¯å¢ƒé…ç½®

```swift
// AppDelegate.swift
func application(_ application: UIApplication, didFinishLaunchingWithOptions...) {
    #if DEBUG
    // å¼€å‘ç¯å¢ƒï¼šè¯¦ç»†æ—¥å¿— + æ§åˆ¶å°è¾“å‡º
    Logger.shared.minLevel = .verbose
    #else
    // ç”Ÿäº§ç¯å¢ƒï¼šåªè®°å½•é‡è¦æ—¥å¿—
    Logger.shared.minLevel = .warning
    
    // ç§»é™¤é»˜è®¤çš„æ§åˆ¶å°è¾“å‡º
    Logger.shared.removeAllDestinations()
    
    // æ·»åŠ æ–‡ä»¶æ—¥å¿—
    let fileDestination = FileLogDestination()
    fileDestination.minLevel = .info
    Logger.shared.addDestination(fileDestination)
    
    // æ·»åŠ è¿œç¨‹æ—¥å¿—ï¼ˆåªä¸ŠæŠ¥é”™è¯¯ï¼‰
    let remoteDestination = RemoteLogDestination(
        serverURL: "https://logs.yourapp.com/collect"
    )
    remoteDestination.minLevel = .error
    Logger.shared.addDestination(remoteDestination)
    #endif
}
```

### 3. æ€§èƒ½ä¼˜åŒ–

**é¿å…å­—ç¬¦ä¸²æ’å€¼**:
```swift
// âŒ ä¸å¥½çš„åšæ³•ï¼ˆå­—ç¬¦ä¸²æ€»æ˜¯ä¼šè®¡ç®—ï¼‰
logDebug("å¤æ‚è®¡ç®—ç»“æœï¼š\(expensiveComputation())")

// âœ… å¥½çš„åšæ³•ï¼ˆå…ˆæ£€æŸ¥çº§åˆ«ï¼‰
if Logger.shared.minLevel <= .debug {
    logDebug("å¤æ‚è®¡ç®—ç»“æœï¼š\(expensiveComputation())")
}
```

**ä½¿ç”¨é—­åŒ…å»¶è¿Ÿè®¡ç®—**:
```swift
// å¯ä»¥æ‰©å±• Logger æ”¯æŒé—­åŒ…å‚æ•°
func debug(_ messageClosure: @autoclosure () -> String) {
    guard level >= minLevel else { return }
    log(.debug, messageClosure())
}
```

### 4. é”™è¯¯è¿½è¸ª

```swift
func handleNetworkError(_ error: Error) {
    logError("ç½‘ç»œè¯·æ±‚å¤±è´¥")
    logError("é”™è¯¯ç±»å‹ï¼š\(type(of: error))")
    logError("é”™è¯¯æè¿°ï¼š\(error.localizedDescription)")
    
    if let urlError = error as? URLError {
        logError("é”™è¯¯ä»£ç ï¼š\(urlError.code.rawValue)")
        logError("å¤±è´¥ URLï¼š\(urlError.failingURL?.absoluteString ?? "æœªçŸ¥")")
    }
}
```

---

## ğŸ› ï¸ è‡ªå®šä¹‰æ‰©å±•

### åˆ›å»ºè‡ªå®šä¹‰æ ¼å¼åŒ–å™¨

```swift
class CustomLogFormatter: LogFormatter {
    func format(_ message: LogMessage) -> String {
        // è‡ªå®šä¹‰æ ¼å¼ï¼šåªæ˜¾ç¤ºæ—¶é—´å’Œæ¶ˆæ¯
        let time = message.formattedTimestamp.suffix(8)  // åªæ˜¾ç¤ºæ—¶:åˆ†:ç§’
        return "\(time) | \(message.level.symbol) \(message.message)"
    }
}

// ä½¿ç”¨
let consoleDestination = ConsoleLogDestination()
consoleDestination.formatter = CustomLogFormatter()
Logger.shared.addDestination(consoleDestination)
```

### åˆ›å»ºè‡ªå®šä¹‰è¾“å‡ºç›®æ ‡

```swift
class DatabaseLogDestination: LogDestination {
    var minLevel: LogLevel = .error
    var formatter: LogFormatter = JSONLogFormatter()
    
    func send(_ message: LogMessage) {
        guard message.level >= minLevel else { return }
        
        // ä¿å­˜åˆ°æ•°æ®åº“
        let logEntry = LogEntry(
            level: message.level.name,
            message: message.message,
            timestamp: message.timestamp
        )
        
        DatabaseManager.shared.insert(logEntry)
    }
}

// ä½¿ç”¨
let dbDestination = DatabaseLogDestination()
Logger.shared.addDestination(dbDestination)
```

---

## ğŸ“– å®é™…åº”ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šç½‘ç»œè¯·æ±‚æ—¥å¿—

```swift
class NetworkManager {
    func request(url: URL, completion: @escaping (Result<Data, Error>) -> Void) {
        logInfo("å¼€å§‹ç½‘ç»œè¯·æ±‚ï¼š\(url.absoluteString)")
        
        let startTime = Date()
        
        URLSession.shared.dataTask(with: url) { data, response, error in
            let duration = Date().timeIntervalSince(startTime)
            
            if let error = error {
                logError("è¯·æ±‚å¤±è´¥ï¼š\(error.localizedDescription)")
                logError("URL: \(url.absoluteString)")
                logError("è€—æ—¶: \(duration)ç§’")
                completion(.failure(error))
                return
            }
            
            guard let httpResponse = response as? HTTPURLResponse else {
                logError("æ— æ•ˆçš„å“åº”ç±»å‹")
                completion(.failure(NetworkError.invalidResponse))
                return
            }
            
            logInfo("è¯·æ±‚æˆåŠŸ - çŠ¶æ€ç ï¼š\(httpResponse.statusCode)")
            logInfo("è€—æ—¶ï¼š\(duration)ç§’")
            
            if duration > 3.0 {
                logWarning("è¯·æ±‚è€—æ—¶è¿‡é•¿ï¼š\(duration)ç§’")
            }
            
            completion(.success(data ?? Data()))
        }.resume()
    }
}
```

### ç¤ºä¾‹2ï¼šç”¨æˆ·æ“ä½œè¿½è¸ª

```swift
class UserActionTracker {
    func trackLogin(userId: String) {
        logInfo("ç”¨æˆ·ç™»å½•ï¼šuser_id=\(userId)")
        logDebug("ç™»å½•æ—¶é—´ï¼š\(Date())")
        logDebug("è®¾å¤‡ä¿¡æ¯ï¼š\(UIDevice.current.model)")
    }
    
    func trackPurchase(productId: String, amount: Double) {
        logInfo("ç”¨æˆ·è´­ä¹°ï¼šproduct_id=\(productId), amount=\(amount)")
    }
    
    func trackCrash(error: Error) {
        logFatal("åº”ç”¨å´©æºƒï¼š\(error)")
        logFatal("å †æ ˆä¿¡æ¯ï¼š\(Thread.callStackSymbols)")
    }
}
```

### ç¤ºä¾‹3ï¼šæ€§èƒ½ç›‘æ§

```swift
class PerformanceMonitor {
    func monitorMemory() {
        let usedMemory = getUsedMemory()
        let totalMemory = getTotalMemory()
        let percentage = (usedMemory / totalMemory) * 100
        
        if percentage > 80 {
            logWarning("å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜ï¼š\(Int(percentage))%")
        } else {
            logDebug("å†…å­˜ä½¿ç”¨ç‡ï¼š\(Int(percentage))%")
        }
    }
    
    func monitorFPS() {
        let fps = getCurrentFPS()
        
        if fps < 30 {
            logWarning("FPS è¿‡ä½ï¼š\(fps)")
        } else if fps < 50 {
            logDebug("FPSï¼š\(fps)")
        }
    }
}
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. é¿å…æ•æ„Ÿä¿¡æ¯

```swift
// âŒ ä¸è¦è®°å½•æ•æ„Ÿä¿¡æ¯
logInfo("ç”¨æˆ·å¯†ç ï¼š\(password)")
logInfo("ä¿¡ç”¨å¡å·ï¼š\(cardNumber)")

// âœ… ä½¿ç”¨è„±æ•å¤„ç†
logInfo("ç”¨æˆ·ç™»å½•ï¼šuser_id=\(userId)")
logInfo("æ”¯ä»˜æˆåŠŸï¼šå¡å·å°¾å·=\(cardNumber.suffix(4))")
```

### 2. æ§åˆ¶æ—¥å¿—æ•°é‡

```swift
// âŒ é¿å…åœ¨å¾ªç¯ä¸­å¤§é‡è¾“å‡º
for i in 0..<10000 {
    logDebug("å¤„ç†ç¬¬ \(i) æ¡æ•°æ®")  // ä¼šè¾“å‡º 10000 æ¡ï¼
}

// âœ… é€‚åº¦è¾“å‡º
for i in 0..<10000 {
    if i % 1000 == 0 {
        logDebug("å¤„ç†è¿›åº¦ï¼š\(i)/10000")
    }
}
```

### 3. çº¿ç¨‹å®‰å…¨

```swift
// Logger æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥åœ¨ä»»æ„çº¿ç¨‹è°ƒç”¨
DispatchQueue.global().async {
    logInfo("åå°çº¿ç¨‹æ‰§è¡Œ")  // âœ… å®‰å…¨
}
```

### 4. æ–‡ä»¶æ¸…ç†

```swift
// å®šæœŸæ¸…ç†æ—§æ—¥å¿—ï¼ˆå¯åœ¨åº”ç”¨å¯åŠ¨æ—¶æ‰§è¡Œï¼‰
if let fileDestination = Logger.shared.destinations.first(where: { $0 is FileLogDestination }) as? FileLogDestination {
    fileDestination.clearAllLogs()
    logInfo("å·²æ¸…ç†æ—§æ—¥å¿—æ–‡ä»¶")
}
```

---

## ğŸ” è°ƒè¯•æŠ€å·§

### 1. è¿‡æ»¤æ—¥å¿—

åœ¨ Xcode æ§åˆ¶å°ä¸­ä½¿ç”¨æœç´¢åŠŸèƒ½ï¼š
- æœç´¢ `[ERROR]` - åªçœ‹é”™è¯¯æ—¥å¿—
- æœç´¢ `LoginViewController` - åªçœ‹ç‰¹å®šæ–‡ä»¶çš„æ—¥å¿—
- æœç´¢ `ç”¨æˆ·ç™»å½•` - æœç´¢ç‰¹å®šå…³é”®è¯

### 2. ä¸´æ—¶è°ƒæ•´çº§åˆ«

```swift
// ä¸´æ—¶æé«˜æ—¥å¿—çº§åˆ«æ¥æ’æŸ¥é—®é¢˜
Logger.shared.minLevel = .verbose

// æ’æŸ¥å®Œæˆåæ¢å¤
Logger.shared.minLevel = .info
```

### 3. æ¡ä»¶æ—¥å¿—

```swift
#if DEBUG
logDebug("å¼€å‘ç¯å¢ƒä¸“ç”¨æ—¥å¿—")
#endif

if isVerboseMode {
    logVerbose("è¯¦ç»†è¿½è¸ªä¿¡æ¯")
}
```

---

## ğŸ“Š æ€§èƒ½å½±å“

### æ—¥å¿—ç³»ç»Ÿå¼€é”€

| æ“ä½œ | å¼€é”€ | è¯´æ˜ |
|------|------|------|
| æ—¥å¿—è®°å½• | æä½ | å¼‚æ­¥å¤„ç†ï¼Œä¸é˜»å¡ä¸»çº¿ç¨‹ |
| æ–‡ä»¶å†™å…¥ | ä½ | åå°é˜Ÿåˆ—ï¼Œæ‰¹é‡å†™å…¥ |
| å­—ç¬¦ä¸²æ ¼å¼åŒ– | ä¸­ | åªåœ¨éœ€è¦æ—¶æ‰§è¡Œ |
| è¿œç¨‹ä¸ŠæŠ¥ | ä¸­ | ç¼“å†²æœºåˆ¶ï¼Œæ‰¹é‡å‘é€ |

### ä¼˜åŒ–å»ºè®®

1. **å¼€å‘ç¯å¢ƒ**: ä½¿ç”¨ VERBOSE/DEBUGï¼Œæ‰€æœ‰æ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°
2. **æµ‹è¯•ç¯å¢ƒ**: ä½¿ç”¨ INFOï¼Œä¿å­˜åˆ°æ–‡ä»¶
3. **ç”Ÿäº§ç¯å¢ƒ**: ä½¿ç”¨ WARNINGï¼Œåªè®°å½•è­¦å‘Šå’Œé”™è¯¯ï¼Œä¸ŠæŠ¥ä¸¥é‡é”™è¯¯

---

## ğŸ“ å­¦ä¹ è¦ç‚¹

### 1. è®¾è®¡æ¨¡å¼

- **ç­–ç•¥æ¨¡å¼**: LogFormatter å¯æ›¿æ¢çš„æ ¼å¼åŒ–ç­–ç•¥
- **è§‚å¯Ÿè€…æ¨¡å¼**: å¤šä¸ªè¾“å‡ºç›®æ ‡åŒæ—¶æ¥æ”¶æ—¥å¿—
- **å•ä¾‹æ¨¡å¼**: Logger.shared å…¨å±€è®¿é—®
- **å·¥å‚æ¨¡å¼**: åˆ›å»ºä¸åŒç±»å‹çš„è¾“å‡ºç›®æ ‡

### 2. Swift ç‰¹æ€§

- **é»˜è®¤å‚æ•°**: `#file`, `#function`, `#line`
- **åè®®**: LogFormatter, LogDestination
- **æšä¸¾**: LogLevel çº§åˆ«å®šä¹‰
- **æ³›å‹**: ç±»å‹å®‰å…¨çš„æ—¥å¿—ç³»ç»Ÿ

### 3. çº¿ç¨‹å®‰å…¨

- **DispatchQueue**: ä¸²è¡Œé˜Ÿåˆ—ä¿æŠ¤å…±äº«æ•°æ®
- **NSRecursiveLock**: é€’å½’é”é¿å…æ­»é”
- **å¼±å¼•ç”¨**: é¿å…å¾ªç¯å¼•ç”¨

---

## ğŸ“ æ€»ç»“

æ—¥å¿—æ¡†æ¶æ¼”ç¤ºå±•ç¤ºäº†ï¼š

1. âœ… å®Œæ•´çš„å¤šçº§åˆ«æ—¥å¿—ç³»ç»Ÿ
2. âœ… çµæ´»çš„è¾“å‡ºç›®æ ‡é…ç½®
3. âœ… å¼ºå¤§çš„æ ¼å¼åŒ–åŠŸèƒ½
4. âœ… æ–‡ä»¶è½®è½¬å’Œç®¡ç†
5. âœ… è¿œç¨‹æ—¥å¿—ä¸ŠæŠ¥
6. âœ… çº¿ç¨‹å®‰å…¨è®¾è®¡
7. âœ… ä¼ä¸šçº§åº”ç”¨æœ€ä½³å®è·µ

è¿™æ˜¯å­¦ä¹ æ—¥å¿—ç³»ç»Ÿè®¾è®¡çš„ä¼˜ç§€ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•æ„å»ºä¸€ä¸ªç”Ÿäº§çº§åˆ«çš„æ—¥å¿—æ¡†æ¶ã€‚

---

## ğŸš€ ä¸‹ä¸€æ­¥

- ä½“éªŒä¸åŒçº§åˆ«çš„æ—¥å¿—è¾“å‡º
- æŸ¥çœ‹æ§åˆ¶å°ä¸­çš„è¯¦ç»†æ—¥å¿—æ ¼å¼
- å°è¯•ä¿å­˜æ—¥å¿—åˆ°æ–‡ä»¶
- ç†è§£æ—¥å¿—ç³»ç»Ÿçš„æ¶æ„è®¾è®¡
- åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­é›†æˆæ—¥å¿—æ¡†æ¶

ç¥å­¦ä¹ æ„‰å¿«ï¼ğŸ“


